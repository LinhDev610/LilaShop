# PROMPT CHI TIáº¾T: XÃ‚Y Dá»°NG Há»† THá»NG CHATBOT AI CHO WEBSITE Má»¸ PHáº¨M

## ğŸ“‹ Tá»”NG QUAN Há»† THá»NG

XÃ¢y dá»±ng má»™t há»‡ thá»‘ng Chatbot AI tÆ° váº¥n sáº£n pháº©m má»¹ pháº©m vá»›i cÃ¡c Ä‘áº·c Ä‘iá»ƒm sau:

### CÃ´ng Nghá»‡ Sá»­ Dá»¥ng
- **Backend**: Spring Boot (Java) hoáº·c Node.js/Python
- **Frontend**: ReactJS hoáº·c framework tÆ°Æ¡ng Ä‘Æ°Æ¡ng
- **AI Service**: Google Gemini API (hoáº·c OpenAI GPT, Claude)
- **Database**: MySQL/PostgreSQL
- **Cache**: In-memory cache hoáº·c Redis

### Má»¥c TiÃªu
- TÆ° váº¥n sáº£n pháº©m má»¹ pháº©m dá»±a trÃªn database thá»±c táº¿ 
- TÆ° váº¥n sáº£n pháº©m theo nhu cáº§u ngÆ°á»i dÃ¹ng
+ Da dáº§u / khÃ´ / nháº¡y cáº£m
+ CÃ³ má»¥n khÃ´ng? má»¥n viÃªm hay má»¥n áº©n
+ NgÃ¢n sÃ¡ch bao nhiÃªu?
+ ThÃ­ch thÆ°Æ¡ng hiá»‡u nÃ o?
+ Bot lá»c sáº£n pháº©m phÃ¹ há»£p trong DB: â€œDá»±a trÃªn da dáº§u â€“ má»¥n â€“ ngÃ¢n sÃ¡ch 300k, mÃ¬nh gá»£i Ã½ 3 sáº£n pháº©m sauâ€¦â€,
+ CÃ¡i nÃ y khÃ¡c search/filter thÃ´ng thÆ°á»ng á»Ÿ chá»—: ngÆ°á»i dÃ¹ng khÃ´ng cáº§n biáº¿t má»¹ pháº©m, chatbot dáº«n dáº¯t nhÆ° nhÃ¢n viÃªn bÃ¡n hÃ ng
-> Trong má»¥c chat trÆ°á»›c háº¿t Ä‘Æ°a ra cÃ¡c má»¥c cho khÃ¡ch hÃ ng chá»n tÃ¬m kiáº¿m theo lÄ©nh vá»±c nÃ o, nhu cáº§u ra sao, Ä‘Æ°a ra cÃ¡c má»¥c cho khÃ¡ch chá»n, sau Ä‘Ã³ AI sáº½ Ä‘i theo danh má»¥c Ä‘Ã³ Ä‘á»ƒ Ä‘á»c danh sÃ¡ch sáº£n pháº©m thay vÃ¬ táº£i háº¿t sáº½ vá»«a khiÃ©n khÃ¡ch khi báº¯t Ä‘áº§u dá»… chá»n, dá»… tÃ¬m kiáº¿m, tá»‘i Æ°u tá»‘c Ä‘á»™, dung lÆ°á»£ng, vÃ  Ä‘Æ°a ra cÃ¡c danh má»¥c phÃ¹ há»£p vá»›i nhu cáº§u cá»§a khÃ¡ch (danh má»¥c chá»n pháº£i Ä‘Ãºng nhÆ° trong DB)
- Chatbot = Trá»£ lÃ½ chÄƒm sÃ³c da cÃ¡ nhÃ¢n:
+ XÃ¢y dá»±ng routine chÄƒm sÃ³c da
+ Chatbot cÃ³ thá»ƒ táº¡o:
    + Routine sÃ¡ng / tá»‘i
    + Thá»© tá»± dÃ¹ng má»¹ pháº©m
    + Thá»i gian chá» giá»¯a cÃ¡c bÆ°á»›c
    + VÃ­ dá»¥:
    â€œSÃ¡ng: Sá»¯a rá»­a máº·t â†’ Toner â†’ Serum â†’ Kem chá»‘ng náº¯ng
    Tá»‘i: Táº©y trang â†’ SRM â†’ Treatment â†’ Kem dÆ°á»¡ngâ€
- Gá»£i Ã½ combo & khuyáº¿n mÃ£i
- Chatbot nÃ³i chuyá»‡n nhÆ° chuyÃªn gia da liá»…u (giá»›i háº¡n)
+ KhÃ´ng cháº©n Ä‘oÃ¡n bá»‡nh
+ Chá»‰ tÆ° váº¥n má»©c má»¹ pháº©m
+ CÃ³ cáº£nh bÃ¡o: â€œKhÃ´ng thay tháº¿ bÃ¡c sÄ©â€
Chatbot so sÃ¡nh sáº£n pháº©m
+ â€œSáº£n pháº©m A vÃ  B khÃ¡c nhau á»Ÿ Ä‘Ã¢u?â€
+ Bot tráº£ lá»i:
+ ThÃ nh pháº§n chÃ­nh
+ Äá»‘i tÆ°á»£ng phÃ¹ há»£p
+ GiÃ¡ & dung tÃ­ch
- Duy trÃ¬ context conversation qua sessionId
- Há»— trá»£ filter sáº£n pháº©m theo danh má»¥c, thÆ°Æ¡ng hiá»‡u, loáº¡i da
- Tá»‘i Æ°u performance vá»›i caching mechanism

---

## ğŸ—ï¸ KIáº¾N TRÃšC Há»† THá»NG

### 1. Luá»“ng Dá»¯ Liá»‡u (Data Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User gá»­i cÃ¢u há»i qua Frontend                                  â”‚
â”‚  "Báº¡n cÃ³ sáº£n pháº©m nÃ o cho da dáº§u khÃ´ng?"                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ChatbotController.ask()                                        â”‚
â”‚  POST /api/chatbot/ask                                          â”‚
â”‚  Body: { message: "...", sessionId: "..." }                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ChatbotService.ask()                                           â”‚
â”‚  - Kiá»ƒm tra cache sáº£n pháº©m                                      â”‚
â”‚  - Náº¿u cache háº¿t háº¡n â†’ refreshProductsContext()                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ProductService.getActiveProducts()                             â”‚
â”‚  - Query database láº¥y sáº£n pháº©m cÃ³ status = APPROVED            â”‚
â”‚  - Ãp dá»¥ng promotion (náº¿u cÃ³)                                   â”‚
â”‚  - Convert Entity â†’ DTO                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Format thÃ nh Text Context                                      â”‚
â”‚  "DANH SÃCH Sáº¢N PHáº¨M:                                          â”‚
â”‚   1. TÃªn: Kem dÆ°á»¡ng áº©m | GiÃ¡: 250,000 VNÄ | Loáº¡i da: Da dáº§u"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ÄÆ°a vÃ o Prompt cho Gemini AI                                   â”‚
â”‚  systemPrompt + productsContext + userMessage                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gá»i Gemini API                                                 â”‚
â”‚  POST https://generativelanguage.googleapis.com/...             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gemini AI phÃ¢n tÃ­ch vÃ  tráº£ lá»i                                â”‚
â”‚  "ChÃºng tÃ´i cÃ³ sáº£n pháº©m Kem dÆ°á»¡ng áº©m cho da dáº§u..."            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LÆ°u vÃ o Conversation History (sessionId)                       â”‚
â”‚  Tráº£ vá» Frontend                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ Cáº¤U TRÃšC DATABASE

```sql
CREATE TABLE `address` (
  `address_id` varchar(255) PRIMARY KEY NOT NULL,
  `address` varchar(255),
  `country` varchar(255),
  `created_at` datetime(6),
  `is_default` bit(1),
  `districtid` varchar(255),
  `district_name` varchar(255),
  `postal_code` varchar(255),
  `provinceid` varchar(255),
  `province_name` varchar(255),
  `recipient_name` varchar(255),
  `recipient_phone_number` varchar(255),
  `updated_at` datetime(6),
  `ward_code` varchar(255),
  `ward_name` varchar(255)
);

CREATE TABLE `banner_products` (
  `banner_id` varchar(255) NOT NULL,
  `product_id` varchar(255) NOT NULL
);

CREATE TABLE `banners` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `content_type` varchar(50),
  `created_at` datetime(6) NOT NULL,
  `description` text,
  `end_date` date,
  `image_url` varchar(255) NOT NULL,
  `link_url` varchar(255),
  `order_index` int,
  `pending_review` bit(1),
  `rejection_reason` text,
  `start_date` date,
  `status` bit(1) NOT NULL,
  `title` varchar(255) NOT NULL,
  `update_at` datetime(6) NOT NULL,
  `created_by` varchar(255)
);

CREATE TABLE `cart` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `applied_voucher_code` varchar(255),
  `subtotal` double,
  `total_amount` double,
  `voucher_discount` double,
  `user_id` varchar(255) UNIQUE
);

CREATE TABLE `cart_item` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `final_price` double,
  `quantity` int,
  `unit_price` double,
  `cart_id` varchar(255),
  `product_id` varchar(255),
  `variant_id` varchar(255)
);

CREATE TABLE `categories` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `created_at` datetime(6),
  `description` text,
  `name` varchar(255) UNIQUE NOT NULL,
  `status` bit(1) NOT NULL,
  `updated_at` datetime(6),
  `parent_id` varchar(255)
);

CREATE TABLE `chat_messages` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `created_at` datetime(6) NOT NULL,
  `is_read` bit(1) NOT NULL,
  `message` text NOT NULL,
  `read_at` datetime(6),
  `receiver_id` varchar(255) NOT NULL,
  `sender_id` varchar(255) NOT NULL
);

CREATE TABLE `expired_promotions` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `approved_at` datetime(6),
  `approved_by` varchar(255),
  `code` varchar(255),
  `description` varchar(255),
  `discount_value` double NOT NULL,
  `expired_at` datetime(6),
  `expiry_date` date NOT NULL,
  `image_url` varchar(255),
  `is_active` bit(1),
  `max_discount_value` double,
  `min_order_value` double,
  `name` varchar(255) NOT NULL,
  `rejection_reason` varchar(255),
  `start_date` date NOT NULL,
  `status` varchar(255) NOT NULL,
  `submitted_at` datetime(6),
  `submitted_by` varchar(255),
  `usage_count` int
);

CREATE TABLE `expired_vouchers` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `apply_scope` enum(ORDER,CATEGORY,PRODUCT),
  `approved_at` datetime(6),
  `approved_by` varchar(255),
  `code` varchar(255) UNIQUE NOT NULL,
  `description` varchar(255),
  `discount_value` double,
  `discount_value_type` enum(PERCENTAGE,AMOUNT),
  `expired_at` datetime(6),
  `expiry_date` date,
  `image_url` varchar(255),
  `is_active` bit(1),
  `max_discount_value` double,
  `max_order_value` double,
  `min_order_value` double,
  `name` varchar(255),
  `rejection_reason` varchar(255),
  `start_date` date,
  `status` varchar(255),
  `submitted_at` datetime(6),
  `submitted_by` varchar(255),
  `usage_count` int,
  `usage_limit` int
);

CREATE TABLE `financial_records` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `amount` double NOT NULL,
  `occurred_at` datetime(6) NOT NULL,
  `payment_method` enum(MOMO,COD),
  `record_type` enum(ORDER_PAYMENT,REFUND,COMPENSATION) NOT NULL,
  `order_id` varchar(255),
  `product_id` varchar(255)
);

CREATE TABLE `invalidated_token` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `expiry_time` datetime(6)
);

CREATE TABLE `inventory` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `last_updated` date NOT NULL,
  `stock_quantity` int NOT NULL,
  `product_id` varchar(255) UNIQUE NOT NULL
);

CREATE TABLE `notifications` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `created_at` datetime(6) NOT NULL,
  `is_read` bit(1) NOT NULL,
  `link` varchar(512),
  `message` text NOT NULL,
  `read_at` datetime(6),
  `title` varchar(255) NOT NULL,
  `type` varchar(255) NOT NULL
);

CREATE TABLE `order_items` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `final_price` double,
  `quantity` int,
  `unit_price` double,
  `order_id` varchar(255),
  `product_id` varchar(255),
  `variant_id` varchar(255)
);

CREATE TABLE `orders` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `admin_processing_note` text,
  `cancellation_reason` text,
  `cancellation_source` enum(CUSTOMER,STAFF),
  `cart_item_ids` text,
  `order_code` varchar(255) UNIQUE,
  `expected_delivery_date` date,
  `note` text,
  `order_date` date,
  `order_date_time` datetime(6),
  `is_paid` bit(1),
  `payment_method` enum(MOMO,COD),
  `payment_reference` varchar(255),
  `payment_status` enum(INIT,PENDING,PAID,FAILED,CANCELLED),
  `refund_account_holder` varchar(255),
  `refund_account_number` varchar(50),
  `refund_amount` double,
  `refund_bank` varchar(100),
  `refund_confirmed_amount` double,
  `refund_confirmed_penalty` double,
  `refund_confirmed_second_shipping_fee` double,
  `refund_description` text,
  `refund_email` varchar(255),
  `refund_media_urls` text,
  `refund_method` varchar(100),
  `refund_penalty_amount` double,
  `refund_reason_type` varchar(50),
  `refund_rejection_reason` text,
  `refund_rejection_source` varchar(50),
  `refund_return_address` text,
  `refund_return_fee` double,
  `refund_second_shipping_fee` double,
  `refund_selected_product_ids` text,
  `refund_total_paid` double,
  `return_checked_date` date,
  `shipping_address` varchar(255),
  `shipping_fee` double,
  `staff_inspection_result` text,
  `status` enum(CREATED,CONFIRMED,PAID,SHIPPED,DELIVERED,CANCELLED,RETURN_REQUESTED,RETURN_CS_CONFIRMED,RETURN_STAFF_CONFIRMED,REFUNDED,RETURN_REJECTED),
  `total_amount` double,
  `address_id` varchar(255),
  `cart_id` varchar(255) UNIQUE,
  `user_id` varchar(255)
);

CREATE TABLE `otp` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `code` varchar(6) NOT NULL,
  `created_at` datetime(6) NOT NULL,
  `email` varchar(255) NOT NULL,
  `expires_at` datetime(6) NOT NULL,
  `is_used` bit(1) NOT NULL
);

CREATE TABLE `payment` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `amount` double,
  `payment_date` date,
  `payment_method` enum(MOMO,COD),
  `status` enum(INIT,PENDING,PAID,FAILED,CANCELLED),
  `order_id` varchar(255) UNIQUE
);

CREATE TABLE `permission` (
  `name` varchar(255) PRIMARY KEY NOT NULL,
  `description` varchar(255),
  `permissions` varchar(255)
);

CREATE TABLE `product_media` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `display_order` int,
  `is_default` bit(1) NOT NULL,
  `media_type` varchar(255),
  `media_url` varchar(255),
  `product_id` varchar(255) NOT NULL
);

CREATE TABLE `product_variants` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `created_at` datetime(6),
  `is_default` bit(1),
  `name` varchar(255),
  `price` double NOT NULL,
  `purchase_price` double,
  `shade_hex` varchar(255),
  `shade_name` varchar(255),
  `stock_quantity` int,
  `tax` double,
  `unit_price` double,
  `updated_at` datetime(6),
  `product_id` varchar(255) NOT NULL
);

CREATE TABLE `products` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `approved_at` datetime(6),
  `brand` varchar(255),
  `created_at` datetime(6),
  `description` text,
  `discount_value` double,
  `expiry_date` date,
  `height` double,
  `ingredients` text,
  `length` double,
  `name` varchar(255) NOT NULL,
  `origin` varchar(255),
  `price` double NOT NULL,
  `purchase_price` double,
  `quantity_sold` int,
  `rejection_reason` text,
  `safety_note` text,
  `shade_color` varchar(255),
  `skin_concern` varchar(255),
  `skin_type` varchar(255),
  `status` enum(PENDING,APPROVED,REJECTED,DISABLED) NOT NULL,
  `tax` double,
  `unit_price` double NOT NULL,
  `updated_at` datetime(6),
  `usage_instructions` text,
  `volume` varchar(255),
  `weight` double,
  `width` double,
  `approved_by` varchar(255),
  `category_id` varchar(255),
  `default_media_id` varchar(255) UNIQUE,
  `promotion_id` varchar(255),
  `submitted_by` varchar(255)
);

CREATE TABLE `promotion_categories` (
  `promotion_id` varchar(255) NOT NULL,
  `category_id` varchar(255) NOT NULL,
  PRIMARY KEY (`promotion_id`, `category_id`)
);

CREATE TABLE `promotion_products` (
  `promotion_id` varchar(255) NOT NULL,
  `product_id` varchar(255) NOT NULL,
  PRIMARY KEY (`promotion_id`, `product_id`)
);

CREATE TABLE `promotions` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `apply_scope` enum(ORDER,CATEGORY,PRODUCT) NOT NULL,
  `approved_at` datetime(6),
  `code` varchar(255) UNIQUE NOT NULL,
  `description` varchar(255),
  `discount_value` double NOT NULL,
  `discount_value_type` enum(PERCENTAGE,AMOUNT) NOT NULL,
  `expiry_date` date NOT NULL,
  `image_url` varchar(255),
  `is_active` bit(1),
  `loss_threshold` double,
  `max_discount_value` double,
  `min_order_value` double,
  `name` varchar(255) NOT NULL,
  `rejection_reason` varchar(255),
  `start_date` date NOT NULL,
  `status` enum(PENDING_APPROVAL,APPROVED,REJECTED,EXPIRED,DISABLED) NOT NULL,
  `submitted_at` datetime(6),
  `total_loss` double,
  `usage_count` int,
  `approved_by` varchar(255),
  `submitted_by` varchar(255)
);

CREATE TABLE `reviews` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `comment` text,
  `created_at` datetime(6) NOT NULL,
  `name_display` varchar(255),
  `rating` int NOT NULL,
  `reply` text,
  `reply_at` datetime(6),
  `product_id` varchar(255) NOT NULL,
  `user_id` varchar(255) NOT NULL
);

CREATE TABLE `role` (
  `name` varchar(255) PRIMARY KEY NOT NULL,
  `description` varchar(255)
);

CREATE TABLE `shipment` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `estimated_delivery` date,
  `order_code` varchar(255),
  `provider` enum(GHN),
  `shipped_date` date,
  `status` enum(CREATED,PICKED_UP,IN_TRANSIT,DELIVERED,FAILED,CANCELLED),
  `total_fee` bigint,
  `order_id` varchar(255) UNIQUE
);

CREATE TABLE `support_tickets` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `assigned_to` enum(CS,ADMIN) NOT NULL,
  `content` text,
  `created_at` datetime(6) NOT NULL,
  `customer_name` varchar(255),
  `email` varchar(255),
  `handler_id` varchar(255),
  `handler_note` text,
  `order_code` varchar(255) NOT NULL,
  `phone` varchar(255),
  `status` enum(NEW,IN_PROGRESS,RESOLVED,ESCALATED) NOT NULL,
  `updated_at` datetime(6) NOT NULL
);

CREATE TABLE `user_addresses` (
  `user_id` varchar(255) NOT NULL,
  `address_id` varchar(255) NOT NULL,
  PRIMARY KEY (`user_id`, `address_id`)
);

CREATE TABLE `user_notifications` (
  `user_id` varchar(255) NOT NULL,
  `notification_id` varchar(255) NOT NULL,
  PRIMARY KEY (`user_id`, `notification_id`)
);

CREATE TABLE `user_voucher_usage` (
  `user_id` varchar(255) NOT NULL,
  `voucher_id` varchar(255) NOT NULL,
  PRIMARY KEY (`user_id`, `voucher_id`)
);

CREATE TABLE `users` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `is_active` bit(1),
  `address` varchar(255),
  `avatar_url` varchar(255),
  `create_at` date,
  `email` varchar(255),
  `full_name` varchar(255),
  `password` varchar(255),
  `phone_number` varchar(255),
  `role` varchar(255)
);

CREATE TABLE `voucher_categories` (
  `voucher_id` varchar(255) NOT NULL,
  `category_id` varchar(255) NOT NULL,
  PRIMARY KEY (`voucher_id`, `category_id`)
);

CREATE TABLE `voucher_products` (
  `voucher_id` varchar(255) NOT NULL,
  `product_id` varchar(255) NOT NULL,
  PRIMARY KEY (`voucher_id`, `product_id`)
);

CREATE TABLE `vouchers` (
  `id` varchar(255) PRIMARY KEY NOT NULL,
  `apply_scope` enum(ORDER,CATEGORY,PRODUCT) NOT NULL,
  `approved_at` datetime(6),
  `code` varchar(255) UNIQUE NOT NULL,
  `comment` text,
  `discount_value` double,
  `discount_value_type` enum(PERCENTAGE,AMOUNT) NOT NULL,
  `expiry_date` date,
  `image_url` varchar(255),
  `is_active` bit(1),
  `loss_threshold` double,
  `max_discount_value` double,
  `max_order_value` double,
  `min_order_value` double,
  `name` varchar(255),
  `rejection_reason` varchar(255),
  `start_date` date,
  `status` enum(PENDING_APPROVAL,APPROVED,REJECTED,EXPIRED,DISABLED) NOT NULL,
  `submitted_at` datetime(6),
  `total_loss` double,
  `usage_count` int,
  `usage_limit` int,
  `usage_per_user` int,
  `approved_by` varchar(255),
  `submitted_by` varchar(255)
);

ALTER TABLE `banner_products` ADD FOREIGN KEY (`banner_id`) REFERENCES `banners` (`id`);

ALTER TABLE `banner_products` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `banners` ADD FOREIGN KEY (`created_by`) REFERENCES `users` (`id`);

ALTER TABLE `users` ADD FOREIGN KEY (`id`) REFERENCES `cart` (`user_id`);

ALTER TABLE `cart_item` ADD FOREIGN KEY (`cart_id`) REFERENCES `cart` (`id`);

ALTER TABLE `cart_item` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `cart_item` ADD FOREIGN KEY (`variant_id`) REFERENCES `product_variants` (`id`);

ALTER TABLE `categories` ADD FOREIGN KEY (`parent_id`) REFERENCES `categories` (`id`);

ALTER TABLE `chat_messages` ADD FOREIGN KEY (`receiver_id`) REFERENCES `users` (`id`);

ALTER TABLE `chat_messages` ADD FOREIGN KEY (`sender_id`) REFERENCES `users` (`id`);

ALTER TABLE `financial_records` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `financial_records` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `products` ADD FOREIGN KEY (`id`) REFERENCES `inventory` (`product_id`);

ALTER TABLE `order_items` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `order_items` ADD FOREIGN KEY (`variant_id`) REFERENCES `product_variants` (`id`);

ALTER TABLE `order_items` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `orders` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `orders` ADD FOREIGN KEY (`address_id`) REFERENCES `address` (`address_id`);

ALTER TABLE `cart` ADD FOREIGN KEY (`id`) REFERENCES `orders` (`cart_id`);

ALTER TABLE `orders` ADD FOREIGN KEY (`id`) REFERENCES `payment` (`order_id`);

ALTER TABLE `permission` ADD FOREIGN KEY (`permissions`) REFERENCES `role` (`name`);

ALTER TABLE `product_media` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `product_variants` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `products` ADD FOREIGN KEY (`approved_by`) REFERENCES `users` (`id`);

ALTER TABLE `products` ADD FOREIGN KEY (`promotion_id`) REFERENCES `promotions` (`id`);

ALTER TABLE `products` ADD FOREIGN KEY (`submitted_by`) REFERENCES `users` (`id`);

ALTER TABLE `product_media` ADD FOREIGN KEY (`id`) REFERENCES `products` (`default_media_id`);

ALTER TABLE `products` ADD FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`);

ALTER TABLE `promotion_categories` ADD FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`);

ALTER TABLE `promotion_categories` ADD FOREIGN KEY (`promotion_id`) REFERENCES `promotions` (`id`);

ALTER TABLE `promotion_products` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `promotion_products` ADD FOREIGN KEY (`promotion_id`) REFERENCES `promotions` (`id`);

ALTER TABLE `promotions` ADD FOREIGN KEY (`submitted_by`) REFERENCES `users` (`id`);

ALTER TABLE `promotions` ADD FOREIGN KEY (`approved_by`) REFERENCES `users` (`id`);

ALTER TABLE `reviews` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `reviews` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `orders` ADD FOREIGN KEY (`id`) REFERENCES `shipment` (`order_id`);

ALTER TABLE `user_addresses` ADD FOREIGN KEY (`address_id`) REFERENCES `address` (`address_id`);

ALTER TABLE `user_addresses` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `user_notifications` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `user_notifications` ADD FOREIGN KEY (`notification_id`) REFERENCES `notifications` (`id`);

ALTER TABLE `user_voucher_usage` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `user_voucher_usage` ADD FOREIGN KEY (`voucher_id`) REFERENCES `vouchers` (`id`);

ALTER TABLE `users` ADD FOREIGN KEY (`role`) REFERENCES `role` (`name`);

ALTER TABLE `voucher_categories` ADD FOREIGN KEY (`voucher_id`) REFERENCES `vouchers` (`id`);

ALTER TABLE `voucher_categories` ADD FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`);

ALTER TABLE `voucher_products` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `voucher_products` ADD FOREIGN KEY (`voucher_id`) REFERENCES `vouchers` (`id`);

ALTER TABLE `vouchers` ADD FOREIGN KEY (`approved_by`) REFERENCES `users` (`id`);

ALTER TABLE `vouchers` ADD FOREIGN KEY (`submitted_by`) REFERENCES `users` (`id`);

```

### Dá»¯ Liá»‡u Máº«u

```sql
-- Danh má»¥c cha
INSERT INTO categories (id, name, description, status, created_at, updated_at, parent_id) VALUES
('cat-001', 'Má»¹ pháº©m trang Ä‘iá»ƒm máº·t', 'CÃ¡c sáº£n pháº©m chÄƒm sÃ³c vÃ  trang Ä‘iá»ƒm cho khuÃ´n máº·t', TRUE, NOW(), NOW(), NULL),
('cat-002', 'Trang Ä‘iá»ƒm vÃ  chÄƒm sÃ³c máº¯t', 'CÃ¡c sáº£n pháº©m trang Ä‘iá»ƒm vÃ  chÄƒm sÃ³c máº¯t', TRUE, NOW(), NOW(), NULL);

-- Danh má»¥c con
INSERT INTO categories (id, name, description, status, created_at, updated_at, parent_id) VALUES
('cat-006', 'Kem ná»n & Pháº¥n ná»n', 'Kem ná»n vÃ  pháº¥n ná»n cho máº·t', TRUE, NOW(), NOW(), 'cat-001'),
('cat-007', 'Pháº¥n mÃ¡ & Highlighter', 'Pháº¥n mÃ¡ há»“ng vÃ  highlight táº¡o khá»‘i', TRUE, NOW(), NOW(), 'cat-001');

-- Sáº£n pháº©m
INSERT INTO products (id, name, description, brand, shade_color, skin_type, skin_concern, volume, origin, 
                      expiry_date, ingredients, usage_instructions, safety_note, weight, length, width, height, 
                      tax, unit_price, purchase_price, discount_value, price, quantity_sold, status, 
                      created_at, updated_at, submitted_by, approved_by, approved_at, rejection_reason, category_id, promotion_id) VALUES
('prod-001', 'Son LÃ¬ Matte Luxury', 
 'Son mÃ´i lÃ¬ matte cao cáº¥p, lÃ¢u trÃ´i, khÃ´ng khÃ´ mÃ´i. MÃ u sáº¯c Ä‘a dáº¡ng, phÃ¹ há»£p má»i tone da.',
 'Lila Beauty', 'Äá» Ruby', NULL, NULL, '3.5g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Beeswax, Jojoba Oil, Vitamin E, Colorants', 
 'Thoa Ä‘á»u lÃªn mÃ´i, cÃ³ thá»ƒ dÃ¹ng chÃ¬ káº» mÃ´i trÆ°á»›c Ä‘á»ƒ táº¡o viá»n',
 'KhÃ´ng nuá»‘t. TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 5.0, 7.0, 2.0, 2.0, 10.0, 250000.0, 150000.0, 0.0, 250000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-004', 'user-002', NOW(), NULL, 'cat-013', NULL),
('prod-002', 'Kem Ná»n Full Coverage', 
 'Kem ná»n che phá»§ hoÃ n háº£o, khÃ´ng báº¿t dÃ­nh, giá»¯ lá»›p trang Ä‘iá»ƒm lÃ¢u trÃ´i suá»‘t 12 giá».',
 'Lila Beauty', 'Nude Beige', 'Má»i loáº¡i da', 'Che khuyáº¿t Ä‘iá»ƒm', '30ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Dimethicone, Titanium Dioxide, Iron Oxides', 
 'Thoa Ä‘á»u lÃªn máº·t báº±ng cá» hoáº·c bÃ´ng mÃºt, blend ká»¹ vÃ¹ng viá»n',
 'Test thá»­ trÃªn da tay trÆ°á»›c khi dÃ¹ng. TrÃ¡nh vÃ¹ng máº¯t.',
 30.0, 5.0, 5.0, 8.0, 10.0, 450000.0, 250000.0, 50000.0, 400000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-004', 'user-002', NOW(), NULL, 'cat-006', NULL),
('prod-003', 'Palette Pháº¥n Máº¯t 12 MÃ u', 
 'Bá»™ palette pháº¥n máº¯t 12 mÃ u Ä‘a dáº¡ng, dá»… phá»‘i há»£p, Ä‘á»™ bÃ¡m mÃ u cao, khÃ´ng bá»‹ vÃ³n cá»¥c.',
 'Lila Beauty', 'Äa mÃ u', NULL, NULL, '12g', 'Italy', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Talc, Mica, Iron Oxides, Ultramarines', 
 'DÃ¹ng cá» pháº¥n máº¯t Ä‘á»ƒ tÃ¡n mÃ u, cÃ³ thá»ƒ káº¿t há»£p nhiá»u mÃ u Ä‘á»ƒ táº¡o hiá»‡u á»©ng',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 12.0, 12.0, 8.0, 2.0, 10.0, 380000.0, 200000.0, 0.0, 380000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-005', 'user-002', NOW(), NULL, 'cat-009', NULL),
('prod-004', 'Serum Vitamin C SÃ¡ng Da', 
 'Serum chá»©a Vitamin C tinh khiáº¿t, giÃºp lÃ m sÃ¡ng da, giáº£m thÃ¢m nÃ¡m, Ä‘á»u mÃ u da.',
 'Lila Beauty', NULL, 'Da thÆ°á»ng, da khÃ´, da há»—n há»£p', 'LÃ m sÃ¡ng da, giáº£m thÃ¢m', '30ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Ascorbic Acid, Hyaluronic Acid, Niacinamide', 
 'Thoa 2-3 giá»t lÃªn máº·t sau khi rá»­a máº·t, massage nháº¹ nhÃ ng. DÃ¹ng buá»•i tá»‘i.',
 'TrÃ¡nh Ã¡nh náº¯ng sau khi dÃ¹ng. Test thá»­ trÃªn da tay trÆ°á»›c.',
 30.0, 3.0, 3.0, 10.0, 10.0, 550000.0, 300000.0, 0.0, 550000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-005', 'user-002', NOW(), NULL, 'cat-017', NULL),
('prod-005', 'NÆ°á»›c Hoa HÆ°Æ¡ng Hoa Há»“ng', 
 'NÆ°á»›c hoa ná»¯ hÆ°Æ¡ng hoa há»“ng quyáº¿n rÅ©, lÆ°u hÆ°Æ¡ng lÃ¢u, phÃ¹ há»£p dÃ¹ng hÃ ng ngÃ y.',
 'Lila Fragrance', 'Há»“ng', NULL, NULL, '50ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Rose Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 50.0, 5.0, 5.0, 12.0, 10.0, 1200000.0, 600000.0, 200000.0, 1000000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-006', 'user-002', NOW(), NULL, 'cat-019', NULL),
('prod-006', 'Mascara LÃ m DÃ i Mi', 
 'Mascara cÃ´ng thá»©c khÃ´ng vÃ³n cá»¥c, lÃ m dÃ i vÃ  cong mi tá»± nhiÃªn, chá»‘ng nÆ°á»›c.',
 'Lila Beauty', 'Äen', NULL, NULL, '8ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Acrylate Copolymer, Carbon Black, Beeswax', 
 'Cháº£i tá»« chÃ¢n mi lÃªn ngá»n, cÃ³ thá»ƒ cháº£i nhiá»u lá»›p',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. ThÃ¡o báº±ng nÆ°á»›c táº©y trang chuyÃªn dá»¥ng.',
 8.0, 2.0, 2.0, 8.0, 10.0, 280000.0, 150000.0, 0.0, 280000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-006', 'user-002', NOW(), NULL, 'cat-011', NULL),
('prod-007', 'Toner CÃ¢n Báº±ng Da', 
 'Toner lÃ m sáº¡ch sÃ¢u, cÃ¢n báº±ng Ä‘á»™ pH da, se khÃ­t lá»— chÃ¢n lÃ´ng, cáº¥p áº©m nháº¹.',
 'Lila Beauty', NULL, 'Má»i loáº¡i da', 'CÃ¢n báº±ng da, se khÃ­t lá»— chÃ¢n lÃ´ng', '200ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Witch Hazel, Hyaluronic Acid, Niacinamide, Glycerin', 
 'Tháº¥m vÃ o bÃ´ng táº©y trang, lau nháº¹ nhÃ ng lÃªn máº·t sau khi rá»­a máº·t',
 'TrÃ¡nh vÃ¹ng máº¯t. Test thá»­ trÃªn da tay trÆ°á»›c.',
 200.0, 6.0, 6.0, 15.0, 10.0, 320000.0, 180000.0, 0.0, 320000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-004', 'user-002', NOW(), NULL, 'cat-016', NULL),
('prod-008', 'Kem DÆ°á»¡ng áº¨m Ban ÄÃªm', 
 'Kem dÆ°á»¡ng áº©m ban Ä‘Ãªm giÃ u dÆ°á»¡ng cháº¥t, phá»¥c há»“i da trong khi ngá»§, má»m má»‹n sÃ¡ng hÃ´m sau.',
 'Lila Beauty', NULL, 'Da khÃ´, da há»—n há»£p', 'DÆ°á»¡ng áº©m, phá»¥c há»“i da', '50ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Glycerin, Ceramides, Shea Butter, Hyaluronic Acid', 
 'Thoa Ä‘á»u lÃªn máº·t vÃ  cá»• trÆ°á»›c khi Ä‘i ngá»§, massage nháº¹ nhÃ ng',
 'Test thá»­ trÃªn da tay trÆ°á»›c. TrÃ¡nh vÃ¹ng máº¯t.',
 50.0, 5.0, 5.0, 6.0, 10.0, 420000.0, 220000.0, 0.0, 420000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-005', 'user-002', NOW(), NULL, 'cat-018', NULL),
('prod-009', 'Son Tint LÃ¢u TrÃ´i', 
 'Son tint mÃ u nÆ°á»›c, lÃ¢u trÃ´i, khÃ´ng bong trÃ³c, tá»± nhiÃªn nhÆ° khÃ´ng trang Ä‘iá»ƒm.',
 'Lila Beauty', 'Äá» Cam', NULL, NULL, '4g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Water, Glycerin, Colorants, Preservatives', 
 'Thoa Ä‘á»u lÃªn mÃ´i, Ä‘á»ƒ khÃ´ tá»± nhiÃªn',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 4.0, 6.0, 1.5, 1.5, 10.0, 180000.0, 100000.0, 0.0, 180000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-006', 'user-002', NOW(), NULL, 'cat-013', NULL),
('prod-010', 'Kem Chá»‘ng Náº¯ng SPF50+', 
 'Kem chá»‘ng náº¯ng phá»• rá»™ng SPF50+, báº£o vá»‡ da khá»i tia UV, khÃ´ng gÃ¢y báº¿t dÃ­nh.',
 'Lila Beauty', NULL, 'Má»i loáº¡i da', 'Chá»‘ng náº¯ng, báº£o vá»‡ da', '50ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Zinc Oxide, Titanium Dioxide, Hyaluronic Acid', 
 'Thoa Ä‘á»u lÃªn máº·t vÃ  vÃ¹ng da cáº§n báº£o vá»‡ 15 phÃºt trÆ°á»›c khi ra náº¯ng',
 'Thoa láº¡i sau má»—i 2 giá» hoáº·c sau khi bÆ¡i, Ä‘á»• má»“ hÃ´i.',
 50.0, 5.0, 5.0, 8.0, 10.0, 350000.0, 180000.0, 0.0, 350000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-007', 'user-002', NOW(), NULL, 'cat-018', NULL),
('prod-011', 'BÃºt Káº» Máº¯t NÆ°á»›c', 
 'BÃºt káº» máº¯t dáº¡ng nÆ°á»›c, má»±c Ä‘en Ä‘áº­m, khÃ´ng lem, dá»… táº©y trang.',
 'Lila Beauty', 'Äen', NULL, NULL, '0.5ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Carbon Black, Acrylate Copolymer', 
 'Káº» tá»« gÃ³c trong máº¯t ra ngoÃ i, táº¡o Ä‘Æ°á»ng máº£nh hoáº·c Ä‘áº­m tÃ¹y Ã½',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. ThÃ¡o báº±ng nÆ°á»›c táº©y trang.',
 0.5, 1.5, 1.5, 12.0, 10.0, 150000.0, 80000.0, 0.0, 150000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-008', 'user-002', NOW(), NULL, 'cat-010', NULL),
('prod-012', 'Sá»¯a Rá»­a Máº·t Dá»‹u Nháº¹', 
 'Sá»¯a rá»­a máº·t cÃ´ng thá»©c dá»‹u nháº¹, lÃ m sáº¡ch sÃ¢u, khÃ´ng lÃ m khÃ´ da.',
 'Lila Beauty', NULL, 'Da nháº¡y cáº£m, da khÃ´', 'LÃ m sáº¡ch, dÆ°á»¡ng áº©m', '150ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Glycerin, Hyaluronic Acid, Ceramides', 
 'LÃ m Æ°á»›t máº·t, láº¥y lÆ°á»£ng vá»«a Ä‘á»§ massage nháº¹ nhÃ ng, rá»­a sáº¡ch vá»›i nÆ°á»›c',
 'TrÃ¡nh vÃ¹ng máº¯t. DÃ¹ng 2 láº§n/ngÃ y.',
 150.0, 6.0, 6.0, 15.0, 10.0, 280000.0, 150000.0, 0.0, 280000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-009', 'user-002', NOW(), NULL, 'cat-015', NULL),
('prod-013', 'NÆ°á»›c Hoa Nam HÆ°Æ¡ng Gá»—', 
 'NÆ°á»›c hoa nam hÆ°Æ¡ng gá»— máº¡nh máº½, lÆ°u hÆ°Æ¡ng lÃ¢u, phÃ¹ há»£p dÃ¹ng hÃ ng ngÃ y.',
 'Lila Fragrance', 'Gá»—', NULL, NULL, '100ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Wood Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 100.0, 6.0, 6.0, 15.0, 10.0, 2000000.0, 1000000.0, 300000.0, 1700000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-010', 'user-002', NOW(), NULL, 'cat-020', NULL),
('prod-014', 'Pháº¥n MÃ¡ Há»“ng', 
 'Pháº¥n mÃ¡ há»“ng tá»± nhiÃªn, dá»… tÃ¡n, Ä‘á»™ bá»n cao, mÃ u sáº¯c Ä‘a dáº¡ng.',
 'Lila Beauty', 'Há»“ng ÄÃ o', NULL, NULL, '5g', 'Italy', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Talc, Mica, Iron Oxides, Titanium Dioxide', 
 'DÃ¹ng cá» pháº¥n mÃ¡ tÃ¡n Ä‘á»u lÃªn gÃ² mÃ¡, blend ká»¹ vÃ¹ng viá»n',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Test thá»­ trÃªn da tay trÆ°á»›c.',
 5.0, 6.0, 6.0, 2.0, 10.0, 220000.0, 120000.0, 0.0, 220000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-011', 'user-002', NOW(), NULL, 'cat-007', NULL),
('prod-015', 'Highlighter Táº¡o Khá»‘i', 
 'Highlighter táº¡o khá»‘i tá»± nhiÃªn, Ã¡nh sÃ¡ng Ä‘áº¹p, khÃ´ng bá»‹ vÃ³n cá»¥c.',
 'Lila Beauty', 'VÃ ng Kim', NULL, NULL, '6g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Mica, Titanium Dioxide, Iron Oxides', 
 'DÃ¹ng cá» highlight tÃ¡n lÃªn sá»‘ng mÅ©i, gÃ² mÃ¡, trÃ¡n',
 'TrÃ¡nh vÃ¹ng máº¯t. DÃ¹ng lÆ°á»£ng vá»«a pháº£i Ä‘á»ƒ trÃ¡nh quÃ¡ bÃ³ng.',
 6.0, 6.0, 6.0, 2.0, 10.0, 260000.0, 140000.0, 0.0, 260000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-012', 'user-002', NOW(), NULL, 'cat-007', NULL),
('prod-016', 'Kem Che Khuyáº¿t Äiá»ƒm', 
 'Kem che khuyáº¿t Ä‘iá»ƒm che phá»§ cao, khÃ´ng báº¿t dÃ­nh, tá»± nhiÃªn.',
 'Lila Beauty', 'Nude', NULL, NULL, '10ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Dimethicone, Titanium Dioxide, Iron Oxides', 
 'Thoa lÃªn vÃ¹ng cáº§n che, dÃ¹ng ngÃ³n tay hoáº·c cá» blend Ä‘á»u',
 'Test thá»­ trÃªn da tay trÆ°á»›c. TrÃ¡nh vÃ¹ng máº¯t.',
 10.0, 2.0, 2.0, 6.0, 10.0, 180000.0, 100000.0, 0.0, 180000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-013', 'user-002', NOW(), NULL, 'cat-008', NULL),
('prod-017', 'DÆ°á»¡ng MÃ´i Lip Balm', 
 'Kem dÆ°á»¡ng mÃ´i má»m má»‹n, cáº¥p áº©m tá»‘t, cÃ³ SPF báº£o vá»‡ mÃ´i.',
 'Lila Beauty', NULL, NULL, NULL, '4g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Beeswax, Jojoba Oil, Vitamin E, SPF15', 
 'Thoa Ä‘á»u lÃªn mÃ´i, cÃ³ thá»ƒ dÃ¹ng nhiá»u láº§n trong ngÃ y',
 'KhÃ´ng nuá»‘t. TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t.',
 4.0, 2.0, 2.0, 2.0, 10.0, 80000.0, 40000.0, 0.0, 80000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-014', 'user-002', NOW(), NULL, 'cat-014', NULL),
('prod-018', 'NÆ°á»›c Hoa Unisex HÆ°Æ¡ng TrÃ¡i CÃ¢y', 
 'NÆ°á»›c hoa unisex hÆ°Æ¡ng trÃ¡i cÃ¢y tÆ°Æ¡i mÃ¡t, phÃ¹ há»£p cáº£ nam vÃ  ná»¯.',
 'Lila Fragrance', 'TrÃ¡i CÃ¢y', NULL, NULL, '50ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Fruit Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 50.0, 5.0, 5.0, 12.0, 10.0, 1500000.0, 750000.0, 250000.0, 1250000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-015', 'user-002', NOW(), NULL, 'cat-021', NULL),
('prod-019', 'Son Kem LÃ¬ SiÃªu Bá»n', 
 'Son kem lÃ¬ siÃªu bá»n, khÃ´ng trÃ´i mÃ u, má»m má»‹n trÃªn mÃ´i.',
 'Lila Beauty', 'Äá» Cam', NULL, NULL, '4.5g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Beeswax, Jojoba Oil, Vitamin E, Colorants', 
 'Thoa Ä‘á»u lÃªn mÃ´i, Ä‘á»ƒ khÃ´ tá»± nhiÃªn',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 4.5, 7.0, 2.0, 2.0, 10.0, 220000.0, 120000.0, 0.0, 220000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-016', 'user-002', NOW(), NULL, 'cat-013', NULL),
('prod-020', 'Kem Ná»n Cushion', 
 'Kem ná»n dáº¡ng cushion tiá»‡n lá»£i, che phá»§ tá»± nhiÃªn, dá»… mang theo.',
 'Lila Beauty', 'Natural', 'Má»i loáº¡i da', 'Che khuyáº¿t Ä‘iá»ƒm', '15g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Dimethicone, Titanium Dioxide, Iron Oxides', 
 'DÃ¹ng bÃ´ng cushion thoa Ä‘á»u lÃªn máº·t',
 'Test thá»­ trÃªn da tay trÆ°á»›c. TrÃ¡nh vÃ¹ng máº¯t.',
 15.0, 6.0, 6.0, 2.0, 10.0, 380000.0, 200000.0, 0.0, 380000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-017', 'user-002', NOW(), NULL, 'cat-006', NULL),
('prod-021', 'Palette Pháº¥n Máº¯t 24 MÃ u', 
 'Bá»™ palette pháº¥n máº¯t 24 mÃ u cao cáº¥p, Ä‘a dáº¡ng, dá»… phá»‘i há»£p.',
 'Lila Beauty', 'Äa mÃ u', NULL, NULL, '24g', 'Italy', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Talc, Mica, Iron Oxides, Ultramarines', 
 'DÃ¹ng cá» pháº¥n máº¯t Ä‘á»ƒ tÃ¡n mÃ u, káº¿t há»£p nhiá»u mÃ u',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 24.0, 15.0, 10.0, 2.0, 10.0, 650000.0, 350000.0, 50000.0, 600000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-018', 'user-002', NOW(), NULL, 'cat-009', NULL),
('prod-022', 'Serum Retinol Chá»‘ng LÃ£o HÃ³a', 
 'Serum Retinol chá»‘ng lÃ£o hÃ³a, giáº£m náº¿p nhÄƒn, lÃ m má»‹n da.',
 'Lila Beauty', NULL, 'Da thÆ°á»ng, da khÃ´', 'Chá»‘ng lÃ£o hÃ³a, giáº£m náº¿p nhÄƒn', '30ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Retinol, Hyaluronic Acid, Niacinamide', 
 'Thoa 2-3 giá»t lÃªn máº·t buá»•i tá»‘i, massage nháº¹ nhÃ ng',
 'TrÃ¡nh Ã¡nh náº¯ng sau khi dÃ¹ng. Test thá»­ trÃªn da tay trÆ°á»›c.',
 30.0, 3.0, 3.0, 10.0, 10.0, 680000.0, 350000.0, 0.0, 680000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-019', 'user-002', NOW(), NULL, 'cat-017', NULL),
('prod-023', 'NÆ°á»›c Hoa Ná»¯ HÆ°Æ¡ng Hoa NhÃ i', 
 'NÆ°á»›c hoa ná»¯ hÆ°Æ¡ng hoa nhÃ i thanh khiáº¿t, quyáº¿n rÅ©, lÆ°u hÆ°Æ¡ng lÃ¢u.',
 'Lila Fragrance', 'Tráº¯ng', NULL, NULL, '50ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Jasmine Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 50.0, 5.0, 5.0, 12.0, 10.0, 1100000.0, 550000.0, 100000.0, 1000000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-020', 'user-002', NOW(), NULL, 'cat-019', NULL),
('prod-024', 'Gel Káº» Máº¯t', 
 'Gel káº» máº¯t mÆ°á»£t mÃ , dá»… tÃ¡n, Ä‘á»™ bá»n cao, khÃ´ng lem.',
 'Lila Beauty', 'Äen', NULL, NULL, '3g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Carbon Black, Acrylate Copolymer', 
 'DÃ¹ng cá» káº» máº¯t tÃ¡n Ä‘á»u, táº¡o Ä‘Æ°á»ng máº£nh hoáº·c Ä‘áº­m',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. ThÃ¡o báº±ng nÆ°á»›c táº©y trang.',
 3.0, 2.0, 2.0, 8.0, 10.0, 160000.0, 85000.0, 0.0, 160000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-021', 'user-002', NOW(), NULL, 'cat-010', NULL),
('prod-025', 'Mascara Chá»‘ng NÆ°á»›c', 
 'Mascara chá»‘ng nÆ°á»›c, lÃ m dÃ i vÃ  cong mi, khÃ´ng vÃ³n cá»¥c.',
 'Lila Beauty', 'Äen', NULL, NULL, '8ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Acrylate Copolymer, Carbon Black, Beeswax', 
 'Cháº£i tá»« chÃ¢n mi lÃªn ngá»n, cÃ³ thá»ƒ cháº£i nhiá»u lá»›p',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. ThÃ¡o báº±ng nÆ°á»›c táº©y trang chuyÃªn dá»¥ng.',
 8.0, 2.0, 2.0, 8.0, 10.0, 300000.0, 160000.0, 0.0, 300000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-022', 'user-002', NOW(), NULL, 'cat-011', NULL),
('prod-026', 'Toner Cáº¥p áº¨m', 
 'Toner cáº¥p áº©m sÃ¢u, lÃ m má»m da, se khÃ­t lá»— chÃ¢n lÃ´ng.',
 'Lila Beauty', NULL, 'Da khÃ´, da há»—n há»£p', 'Cáº¥p áº©m, lÃ m má»m da', '200ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Hyaluronic Acid, Glycerin, Niacinamide', 
 'Tháº¥m vÃ o bÃ´ng táº©y trang, lau nháº¹ nhÃ ng lÃªn máº·t',
 'TrÃ¡nh vÃ¹ng máº¯t. Test thá»­ trÃªn da tay trÆ°á»›c.',
 200.0, 6.0, 6.0, 15.0, 10.0, 340000.0, 190000.0, 0.0, 340000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-023', 'user-002', NOW(), NULL, 'cat-016', NULL),
('prod-027', 'Kem DÆ°á»¡ng Ban NgÃ y', 
 'Kem dÆ°á»¡ng ban ngÃ y nháº¹ nhÃ ng, cáº¥p áº©m, cÃ³ SPF báº£o vá»‡ da.',
 'Lila Beauty', NULL, 'Má»i loáº¡i da', 'DÆ°á»¡ng áº©m, chá»‘ng náº¯ng', '50ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Glycerin, SPF30, Hyaluronic Acid', 
 'Thoa Ä‘á»u lÃªn máº·t buá»•i sÃ¡ng, massage nháº¹ nhÃ ng',
 'Test thá»­ trÃªn da tay trÆ°á»›c. TrÃ¡nh vÃ¹ng máº¯t.',
 50.0, 5.0, 5.0, 6.0, 10.0, 450000.0, 230000.0, 0.0, 450000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-024', 'user-002', NOW(), NULL, 'cat-018', NULL),
('prod-028', 'Son Thá»i Classic', 
 'Son thá»i classic truyá»n thá»‘ng, mÃ u sáº¯c Ä‘a dáº¡ng, bá»n mÃ u.',
 'Lila Beauty', 'Äá»', NULL, NULL, '3.5g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Beeswax, Jojoba Oil, Vitamin E, Colorants', 
 'Thoa Ä‘á»u lÃªn mÃ´i, cÃ³ thá»ƒ dÃ¹ng chÃ¬ káº» mÃ´i trÆ°á»›c',
 'KhÃ´ng nuá»‘t. TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t.',
 3.5, 7.0, 2.0, 2.0, 10.0, 200000.0, 110000.0, 0.0, 200000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-025', 'user-002', NOW(), NULL, 'cat-012', NULL),
('prod-029', 'Sá»¯a Rá»­a Máº·t Táº©y Trang', 
 'Sá»¯a rá»­a máº·t káº¿t há»£p táº©y trang, lÃ m sáº¡ch sÃ¢u, dá»‹u nháº¹.',
 'Lila Beauty', NULL, 'Má»i loáº¡i da', 'LÃ m sáº¡ch, táº©y trang', '150ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Glycerin, Hyaluronic Acid, Ceramides', 
 'LÃ m Æ°á»›t máº·t, láº¥y lÆ°á»£ng vá»«a Ä‘á»§ massage, rá»­a sáº¡ch',
 'TrÃ¡nh vÃ¹ng máº¯t. DÃ¹ng 2 láº§n/ngÃ y.',
 150.0, 6.0, 6.0, 15.0, 10.0, 290000.0, 160000.0, 0.0, 290000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-026', 'user-002', NOW(), NULL, 'cat-015', NULL),
('prod-030', 'NÆ°á»›c Hoa Nam HÆ°Æ¡ng Gá»— ThÆ¡m', 
 'NÆ°á»›c hoa nam hÆ°Æ¡ng gá»— thÆ¡m máº¡nh máº½, nam tÃ­nh, lÆ°u hÆ°Æ¡ng lÃ¢u.',
 'Lila Fragrance', 'Gá»—', NULL, NULL, '100ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Wood Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 100.0, 6.0, 6.0, 15.0, 10.0, 2100000.0, 1050000.0, 350000.0, 1750000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-027', 'user-002', NOW(), NULL, 'cat-020', NULL),
('prod-031', 'Pháº¥n MÃ¡ Há»“ng Tá»± NhiÃªn', 
 'Pháº¥n mÃ¡ há»“ng tá»± nhiÃªn, dá»… tÃ¡n, mÃ u sáº¯c tÆ°Æ¡i táº¯n.',
 'Lila Beauty', 'Há»“ng', NULL, NULL, '5g', 'Italy', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Talc, Mica, Iron Oxides, Titanium Dioxide', 
 'DÃ¹ng cá» pháº¥n mÃ¡ tÃ¡n Ä‘á»u lÃªn gÃ² mÃ¡',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Test thá»­ trÃªn da tay trÆ°á»›c.',
 5.0, 6.0, 6.0, 2.0, 10.0, 240000.0, 130000.0, 0.0, 240000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-028', 'user-002', NOW(), NULL, 'cat-007', NULL),
('prod-032', 'Highlighter Dáº¡ng Lá»ng', 
 'Highlighter dáº¡ng lá»ng dá»… tÃ¡n, Ã¡nh sÃ¡ng tá»± nhiÃªn, khÃ´ng báº¿t.',
 'Lila Beauty', 'VÃ ng Há»“ng', NULL, NULL, '10ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Water, Mica, Titanium Dioxide, Iron Oxides', 
 'DÃ¹ng ngÃ³n tay hoáº·c cá» highlight tÃ¡n lÃªn sá»‘ng mÅ©i, gÃ² mÃ¡',
 'TrÃ¡nh vÃ¹ng máº¯t. DÃ¹ng lÆ°á»£ng vá»«a pháº£i.',
 10.0, 3.0, 3.0, 8.0, 10.0, 280000.0, 150000.0, 0.0, 280000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-029', 'user-002', NOW(), NULL, 'cat-007', NULL),
('prod-033', 'Kem Che Khuyáº¿t Äiá»ƒm Full Coverage', 
 'Kem che khuyáº¿t Ä‘iá»ƒm che phá»§ cao, che Ä‘Æ°á»£c cáº£ thÃ¢m vÃ  má»¥n.',
 'Lila Beauty', 'Nude', NULL, NULL, '10ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Dimethicone, Titanium Dioxide, Iron Oxides', 
 'Thoa lÃªn vÃ¹ng cáº§n che, dÃ¹ng ngÃ³n tay hoáº·c cá» blend',
 'Test thá»­ trÃªn da tay trÆ°á»›c. TrÃ¡nh vÃ¹ng máº¯t.',
 10.0, 2.0, 2.0, 6.0, 10.0, 190000.0, 105000.0, 0.0, 190000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-030', 'user-002', NOW(), NULL, 'cat-008', NULL),
('prod-034', 'DÆ°á»¡ng MÃ´i CÃ³ MÃ u', 
 'DÆ°á»¡ng mÃ´i cÃ³ mÃ u, vá»«a dÆ°á»¡ng vá»«a táº¡o mÃ u tá»± nhiÃªn.',
 'Lila Beauty', 'Há»“ng', NULL, NULL, '4g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Beeswax, Jojoba Oil, Vitamin E, Colorants', 
 'Thoa Ä‘á»u lÃªn mÃ´i, cÃ³ thá»ƒ dÃ¹ng nhiá»u láº§n',
 'KhÃ´ng nuá»‘t. TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t.',
 4.0, 2.0, 2.0, 2.0, 10.0, 90000.0, 45000.0, 0.0, 90000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-031', 'user-002', NOW(), NULL, 'cat-014', NULL),
('prod-035', 'NÆ°á»›c Hoa Unisex HÆ°Æ¡ng Biá»ƒn', 
 'NÆ°á»›c hoa unisex hÆ°Æ¡ng biá»ƒn tÆ°Æ¡i mÃ¡t, phÃ¹ há»£p má»i mÃ¹a.',
 'Lila Fragrance', 'Xanh', NULL, NULL, '50ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Marine Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 50.0, 5.0, 5.0, 12.0, 10.0, 1600000.0, 800000.0, 300000.0, 1300000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-032', 'user-002', NOW(), NULL, 'cat-021', NULL),
('prod-036', 'Son LÃ¬ Matte SiÃªu Bá»n', 
 'Son lÃ¬ matte siÃªu bá»n, khÃ´ng trÃ´i mÃ u, khÃ´ng khÃ´ mÃ´i.',
 'Lila Beauty', 'Äá» Äáº­m', NULL, NULL, '3.5g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Beeswax, Jojoba Oil, Vitamin E, Colorants', 
 'Thoa Ä‘á»u lÃªn mÃ´i, Ä‘á»ƒ khÃ´ tá»± nhiÃªn',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 3.5, 7.0, 2.0, 2.0, 10.0, 270000.0, 140000.0, 0.0, 270000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-033', 'user-002', NOW(), NULL, 'cat-013', NULL),
('prod-037', 'Kem Ná»n BB Cream', 
 'Kem ná»n BB cream Ä‘a nÄƒng, che phá»§, dÆ°á»¡ng da, chá»‘ng náº¯ng.',
 'Lila Beauty', 'Natural', 'Má»i loáº¡i da', 'Che phá»§, dÆ°á»¡ng da', '50ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Dimethicone, Titanium Dioxide, SPF30', 
 'Thoa Ä‘á»u lÃªn máº·t báº±ng tay hoáº·c cá»',
 'Test thá»­ trÃªn da tay trÆ°á»›c. TrÃ¡nh vÃ¹ng máº¯t.',
 50.0, 5.0, 5.0, 8.0, 10.0, 360000.0, 190000.0, 0.0, 360000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-034', 'user-002', NOW(), NULL, 'cat-006', NULL),
('prod-038', 'Palette Pháº¥n Máº¯t 6 MÃ u', 
 'Bá»™ palette pháº¥n máº¯t 6 mÃ u cÆ¡ báº£n, dá»… sá»­ dá»¥ng, giÃ¡ cáº£ há»£p lÃ½.',
 'Lila Beauty', 'Äa mÃ u', NULL, NULL, '6g', 'Italy', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Talc, Mica, Iron Oxides, Ultramarines', 
 'DÃ¹ng cá» pháº¥n máº¯t Ä‘á»ƒ tÃ¡n mÃ u',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 6.0, 8.0, 6.0, 2.0, 10.0, 280000.0, 150000.0, 0.0, 280000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-035', 'user-002', NOW(), NULL, 'cat-009', NULL),
('prod-039', 'Serum Niacinamide Se KhÃ­t Lá»— ChÃ¢n LÃ´ng', 
 'Serum Niacinamide se khÃ­t lá»— chÃ¢n lÃ´ng, kiá»ƒm soÃ¡t dáº§u, lÃ m má»‹n da.',
 'Lila Beauty', NULL, 'Da dáº§u, da há»—n há»£p', 'Se khÃ­t lá»— chÃ¢n lÃ´ng, kiá»ƒm soÃ¡t dáº§u', '30ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Niacinamide, Hyaluronic Acid, Salicylic Acid', 
 'Thoa 2-3 giá»t lÃªn máº·t sau khi rá»­a máº·t, massage nháº¹',
 'TrÃ¡nh Ã¡nh náº¯ng sau khi dÃ¹ng. Test thá»­ trÃªn da tay trÆ°á»›c.',
 30.0, 3.0, 3.0, 10.0, 10.0, 520000.0, 280000.0, 0.0, 520000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-036', 'user-002', NOW(), NULL, 'cat-017', NULL),
('prod-040', 'NÆ°á»›c Hoa Ná»¯ HÆ°Æ¡ng Vanilla', 
 'NÆ°á»›c hoa ná»¯ hÆ°Æ¡ng vanilla ngá»t ngÃ o, áº¥m Ã¡p, quyáº¿n rÅ©.',
 'Lila Fragrance', 'VÃ ng', NULL, NULL, '50ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Vanilla Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 50.0, 5.0, 5.0, 12.0, 10.0, 1300000.0, 650000.0, 250000.0, 1050000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-037', 'user-002', NOW(), NULL, 'cat-019', NULL),
('prod-041', 'BÃºt Káº» Máº¯t Dáº¡ng BÃºt ChÃ¬', 
 'BÃºt káº» máº¯t dáº¡ng bÃºt chÃ¬ dá»… sá»­ dá»¥ng, khÃ´ng lem, dá»… táº©y.',
 'Lila Beauty', 'Äen', NULL, NULL, '0.3g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Carbon Black, Acrylate Copolymer', 
 'Káº» tá»« gÃ³c trong máº¯t ra ngoÃ i, táº¡o Ä‘Æ°á»ng máº£nh',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. ThÃ¡o báº±ng nÆ°á»›c táº©y trang.',
 0.3, 1.5, 1.5, 12.0, 10.0, 120000.0, 65000.0, 0.0, 120000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-038', 'user-002', NOW(), NULL, 'cat-010', NULL),
('prod-042', 'Mascara LÃ m Cong Mi', 
 'Mascara lÃ m cong mi tá»± nhiÃªn, khÃ´ng vÃ³n cá»¥c, dá»… thÃ¡o.',
 'Lila Beauty', 'Äen', NULL, NULL, '8ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Acrylate Copolymer, Carbon Black, Beeswax', 
 'Cháº£i tá»« chÃ¢n mi lÃªn ngá»n, cháº£i nhiá»u lá»›p',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. ThÃ¡o báº±ng nÆ°á»›c táº©y trang.',
 8.0, 2.0, 2.0, 8.0, 10.0, 260000.0, 140000.0, 0.0, 260000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-039', 'user-002', NOW(), NULL, 'cat-011', NULL),
('prod-043', 'Toner Táº©y Táº¿ BÃ o Cháº¿t', 
 'Toner táº©y táº¿ bÃ o cháº¿t nháº¹ nhÃ ng, lÃ m sÃ¡ng da, má»‹n mÃ ng.',
 'Lila Beauty', NULL, 'Da thÆ°á»ng, da há»—n há»£p', 'Táº©y táº¿ bÃ o cháº¿t, lÃ m sÃ¡ng da', '200ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, AHA, BHA, Hyaluronic Acid, Glycerin', 
 'Tháº¥m vÃ o bÃ´ng táº©y trang, lau nháº¹ nhÃ ng lÃªn máº·t',
 'TrÃ¡nh vÃ¹ng máº¯t. Test thá»­ trÃªn da tay trÆ°á»›c. DÃ¹ng buá»•i tá»‘i.',
 200.0, 6.0, 6.0, 15.0, 10.0, 380000.0, 200000.0, 0.0, 380000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-040', 'user-002', NOW(), NULL, 'cat-016', NULL),
('prod-044', 'Kem DÆ°á»¡ng Máº¯t', 
 'Kem dÆ°á»¡ng máº¯t chá»‘ng quáº§ng thÃ¢m, giáº£m náº¿p nhÄƒn, lÃ m sÃ¡ng vÃ¹ng máº¯t.',
 'Lila Beauty', NULL, 'Má»i loáº¡i da', 'Chá»‘ng quáº§ng thÃ¢m, giáº£m náº¿p nhÄƒn', '15ml', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Caffeine, Retinol, Hyaluronic Acid', 
 'Thoa Ä‘á»u lÃªn vÃ¹ng máº¯t, massage nháº¹ nhÃ ng',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Test thá»­ trÆ°á»›c.',
 15.0, 2.0, 2.0, 5.0, 10.0, 480000.0, 250000.0, 0.0, 480000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-041', 'user-002', NOW(), NULL, 'cat-018', NULL),
('prod-045', 'Son Tint MÃ u NÆ°á»›c', 
 'Son tint mÃ u nÆ°á»›c tá»± nhiÃªn, lÃ¢u trÃ´i, khÃ´ng bong trÃ³c.',
 'Lila Beauty', 'Äá» Há»“ng', NULL, NULL, '4g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Water, Glycerin, Colorants, Preservatives', 
 'Thoa Ä‘á»u lÃªn mÃ´i, Ä‘á»ƒ khÃ´ tá»± nhiÃªn',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. NgÆ°ng sá»­ dá»¥ng náº¿u cÃ³ kÃ­ch á»©ng.',
 4.0, 6.0, 1.5, 1.5, 10.0, 170000.0, 95000.0, 0.0, 170000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-042', 'user-002', NOW(), NULL, 'cat-013', NULL),
('prod-046', 'Kem Chá»‘ng Náº¯ng SPF30', 
 'Kem chá»‘ng náº¯ng SPF30 nháº¹ nhÃ ng, khÃ´ng báº¿t dÃ­nh, phÃ¹ há»£p da nháº¡y cáº£m.',
 'Lila Beauty', NULL, 'Da nháº¡y cáº£m', 'Chá»‘ng náº¯ng, báº£o vá»‡ da', '50ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Zinc Oxide, Titanium Dioxide, Hyaluronic Acid', 
 'Thoa Ä‘á»u lÃªn máº·t 15 phÃºt trÆ°á»›c khi ra náº¯ng',
 'Thoa láº¡i sau má»—i 2 giá» hoáº·c sau khi bÆ¡i.',
 50.0, 5.0, 5.0, 8.0, 10.0, 320000.0, 170000.0, 0.0, 320000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-043', 'user-002', NOW(), NULL, 'cat-018', NULL),
('prod-047', 'Sá»¯a Rá»­a Máº·t Táº¡o Bá»t', 
 'Sá»¯a rá»­a máº·t táº¡o bá»t dÃ y, lÃ m sáº¡ch sÃ¢u, khÃ´ng lÃ m khÃ´ da.',
 'Lila Beauty', NULL, 'Má»i loáº¡i da', 'LÃ m sáº¡ch, táº¡o bá»t', '120ml', 'Nháº­t Báº£n', 
 DATE_ADD(CURDATE(), INTERVAL 2 YEAR), 
 'Water, Glycerin, Hyaluronic Acid, Surfactants', 
 'LÃ m Æ°á»›t máº·t, táº¡o bá»t, massage nháº¹, rá»­a sáº¡ch',
 'TrÃ¡nh vÃ¹ng máº¯t. DÃ¹ng 2 láº§n/ngÃ y.',
 120.0, 6.0, 6.0, 12.0, 10.0, 270000.0, 145000.0, 0.0, 270000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-044', 'user-002', NOW(), NULL, 'cat-015', NULL),
('prod-048', 'NÆ°á»›c Hoa Nam HÆ°Æ¡ng Xáº¡ HÆ°Æ¡ng', 
 'NÆ°á»›c hoa nam hÆ°Æ¡ng xáº¡ hÆ°Æ¡ng máº¡nh máº½, nam tÃ­nh, lÆ°u hÆ°Æ¡ng lÃ¢u.',
 'Lila Fragrance', 'NÃ¢u', NULL, NULL, '100ml', 'PhÃ¡p', 
 DATE_ADD(CURDATE(), INTERVAL 5 YEAR), 
 'Alcohol, Water, Fragrance, Musk Extract', 
 'Xá»‹t lÃªn cá»• tay, cá»• vÃ  sau tai. KhÃ´ng chÃ  xÃ¡t.',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Äá»ƒ xa táº§m tay tráº» em.',
 100.0, 6.0, 6.0, 15.0, 10.0, 2200000.0, 1100000.0, 400000.0, 1800000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-045', 'user-002', NOW(), NULL, 'cat-020', NULL),
('prod-049', 'Pháº¥n MÃ¡ Dáº¡ng Kem', 
 'Pháº¥n mÃ¡ dáº¡ng kem dá»… tÃ¡n, mÃ u sáº¯c tá»± nhiÃªn, Ä‘á»™ bá»n cao.',
 'Lila Beauty', 'Há»“ng Cam', NULL, NULL, '5g', 'Italy', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Water, Dimethicone, Iron Oxides, Titanium Dioxide', 
 'DÃ¹ng ngÃ³n tay hoáº·c cá» pháº¥n mÃ¡ tÃ¡n Ä‘á»u lÃªn gÃ² mÃ¡',
 'TrÃ¡nh tiáº¿p xÃºc vá»›i máº¯t. Test thá»­ trÃªn da tay trÆ°á»›c.',
 5.0, 6.0, 6.0, 2.0, 10.0, 250000.0, 135000.0, 0.0, 250000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-046', 'user-002', NOW(), NULL, 'cat-007', NULL),
('prod-050', 'Highlighter Dáº¡ng Bá»™t', 
 'Highlighter dáº¡ng bá»™t má»‹n, Ã¡nh sÃ¡ng Ä‘áº¹p, khÃ´ng bá»‹ vÃ³n cá»¥c.',
 'Lila Beauty', 'VÃ ng Há»“ng', NULL, NULL, '6g', 'HÃ n Quá»‘c', 
 DATE_ADD(CURDATE(), INTERVAL 3 YEAR), 
 'Mica, Titanium Dioxide, Iron Oxides', 
 'DÃ¹ng cá» highlight tÃ¡n lÃªn sá»‘ng mÅ©i, gÃ² mÃ¡, trÃ¡n',
 'TrÃ¡nh vÃ¹ng máº¯t. DÃ¹ng lÆ°á»£ng vá»«a pháº£i.',
 6.0, 6.0, 6.0, 2.0, 10.0, 270000.0, 145000.0, 0.0, 270000.0, 0, 'APPROVED',
 NOW(), NOW(), 'user-047', 'user-002', NOW(), NULL, 'cat-007', NULL) AS new
ON DUPLICATE KEY UPDATE 
    name = new.name, 
    description = new.description, 
    category_id = new.category_id,
    price = new.price,
    status = new.status,
    updated_at = NOW();
```

---

## ğŸ”§ IMPLEMENTATION CHI TIáº¾T

### PHáº¦N 1: BACKEND SERVICE

#### 1.1. ChatbotController (API Endpoint)

**Spring Boot (Java):**

```java
@RestController
@RequestMapping("/api/chatbot")
@RequiredArgsConstructor
@Slf4j
public class ChatbotController {
    
    private final ChatbotService chatbotService;
    
    @PostMapping("/ask")
    public ApiResponse<ChatResponse> ask(@Valid @RequestBody ChatRequest request) {
        log.info("Chatbot request received: {}", request.getMessage());
        ChatResponse response = chatbotService.ask(request);
        return ApiResponse.<ChatResponse>builder()
                .result(response)
                .build();
    }
}
```

**Node.js (Express):**

```javascript
const express = require('express');
const router = express.Router();
const chatbotService = require('../services/chatbotService');

router.post('/ask', async (req, res) => {
    try {
        const { message, sessionId } = req.body;
        console.log('Chatbot request received:', message);
        
        const response = await chatbotService.ask(message, sessionId);
        
        res.json({
            code: 1000,
            result: response
        });
    } catch (error) {
        console.error('Chatbot error:', error);
        res.status(500).json({
            code: 5000,
            message: 'Internal server error'
        });
    }
});

module.exports = router;
```

**Python (Flask):**

```python
from flask import Blueprint, request, jsonify
from services.chatbot_service import ChatbotService
import logging

chatbot_bp = Blueprint('chatbot', __name__)
chatbot_service = ChatbotService()

@chatbot_bp.route('/ask', methods=['POST'])
def ask():
    try:
        data = request.get_json()
        message = data.get('message')
        session_id = data.get('sessionId')
        
        logging.info(f'Chatbot request received: {message}')
        
        response = chatbot_service.ask(message, session_id)
        
        return jsonify({
            'code': 1000,
            'result': response
        })
    except Exception as e:
        logging.error(f'Chatbot error: {str(e)}')
        return jsonify({
            'code': 5000,
            'message': 'Internal server error'
        }), 500
```

---

#### 1.2. ChatbotService (Core Logic)

**CÃ¡c Chá»©c NÄƒng ChÃ­nh:**

1. **Cache Mechanism**: Cache sáº£n pháº©m trong 30 phÃºt
2. **Conversation History**: LÆ°u lá»‹ch sá»­ chat theo sessionId
3. **Smart Context**: Chá»‰ Ä‘Æ°a context cáº§n thiáº¿t vÃ o prompt
4. **Error Handling**: Xá»­ lÃ½ retry cho quota exceeded

**Spring Boot (Java) - Core Methods:**

```java
@Service
@Slf4j
public class ChatbotService {
    
    // Constants
    private static final String GEMINI_API_BASE_URL = "https://generativelanguage.googleapis.com/v1beta";
    private static final long PRODUCTS_CACHE_TTL = 30 * 60 * 1000; // 30 phÃºt
    
    // Dependencies
    private final WebClient webClient;
    private final ProductService productService;
    private final CategoryService categoryService;
    private final String apiKey;
    private final String model;
    
    // Cache
    private String cachedProductsContext = "";
    private long lastProductsCacheUpdate = 0;
    
    // Conversation history (cÃ³ thá»ƒ dÃ¹ng Redis cho production)
    private final Map<String, List<GeminiContent>> conversationHistory = new HashMap<>();
    
    // System Prompt - QUAN TRá»ŒNG NHáº¤T
    private static final String SYSTEM_PROMPT_BASE = """
        Báº¡n lÃ  trá»£ lÃ½ AI chuyÃªn nghiá»‡p cá»§a website Nova Beauty - má»™t cá»­a hÃ ng má»¹ pháº©m vÃ  chÄƒm sÃ³c sáº¯c Ä‘áº¹p uy tÃ­n.
        
        VAI TRÃ’: Há»— trá»£ khÃ¡ch hÃ ng nhiá»‡t tÃ¬nh, chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n. TÆ° váº¥n sáº£n pháº©m, giáº£i Ä‘Ã¡p tháº¯c máº¯c.
        
        QUY Táº®C VÃ€NG (TUYá»†T Äá»I PHáº¢I TUÃ‚N THá»¦):
        1. CHá»ˆ tÆ° váº¥n sáº£n pháº©m CÃ“ TRONG CONTEXT Ä‘Æ°á»£c cung cáº¥p (tá»« database).
        2. TUYá»†T Äá»I KHÃ”NG tá»± nghÄ© ra, táº¡o ra, hoáº·c thay Ä‘á»•i báº¥t ká»³ tÃªn sáº£n pháº©m nÃ o.
        3. TUYá»†T Äá»I KHÃ”NG gá»£i Ã½ sáº£n pháº©m KHÃ”NG CÃ“ trong context/database.
        4. Náº¿u khÃ´ng cÃ³ thÃ´ng tin trong context â†’ NÃ³i "Xin lá»—i, hiá»‡n táº¡i chÆ°a cÃ³ sáº£n pháº©m phÃ¹ há»£p. Báº¡n cÃ³ thá»ƒ liÃªn há»‡ CSKH Ä‘á»ƒ Ä‘Æ°á»£c tÆ° váº¥n thÃªm áº¡."
        
        TÆ¯ Váº¤N Sáº¢N PHáº¨M (CHá»ˆ DÃ™NG THÃ”NG TIN Tá»ª CONTEXT):
        A. Khi khÃ¡ch há»i CHUNG (vÃ­ dá»¥: "cÃ³ son gÃ¬", "cÃ³ kem gÃ¬"):
           - Náº¿u cÃ³ danh má»¥c con: liá»‡t kÃª danh má»¥c con Ä‘á»ƒ khÃ¡ch chá»n
           - Format: "ChÃ o báº¡n! Nova Beauty cÃ³ cÃ¡c loáº¡i [danh má»¥c] sau:\n1. [TÃªn danh má»¥c con 1]\n2. [TÃªn danh má»¥c con 2]\n\nBáº¡n muá»‘n xem chi tiáº¿t danh má»¥c nÃ o áº¡?"
        
        B. Khi khÃ¡ch há»i Cá»¤ THá»‚ (vÃ­ dá»¥: "son dior", "kem chá»‘ng náº¯ng la roche"):
           - CHá»ˆ giá»›i thiá»‡u ngáº¯n gá»n loáº¡i sáº£n pháº©m
           - KHÃ”NG liá»‡t kÃª tÃªn sáº£n pháº©m cá»¥ thá»ƒ trong text (há»‡ thá»‘ng sáº½ tá»± hiá»ƒn thá»‹ card)
           - Náº¿u >20 sáº£n pháº©m: Ä‘á» xuáº¥t lá»c theo thÆ°Æ¡ng hiá»‡u, giÃ¡, loáº¡i da
           - Format: "ChÃ o báº¡n! Nova Beauty cÃ³ cÃ¡c sáº£n pháº©m [loáº¡i] nhÆ° báº¡n Ä‘ang tÃ¬m kiáº¿m. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c sáº£n pháº©m báº¡n cÃ³ thá»ƒ tham kháº£o áº¡:"
        
        C. Khi khÃ¡ch CHá»ŒN sáº£n pháº©m:
           - ÄÆ°a link [LINK:/product/{id}] vá»›i ID CÃ“ TRONG CONTEXT
           - Format: "Báº¡n cÃ³ thá»ƒ xem chi tiáº¿t sáº£n pháº©m [tÃªn] táº¡i: [LINK:/product/{id}]"
        
        D. Khi khÃ¡ch Há»I Vá»€ THÆ¯Æ NG HIá»†U (vÃ­ dá»¥: "cÃ³ son dior"):
           - Náº¿u <10 sáº£n pháº©m: liá»‡t kÃª tÃªn vÃ  link tá»«ng sáº£n pháº©m
           - Náº¿u >=10 sáº£n pháº©m: Ä‘Æ°a link trang thÆ°Æ¡ng hiá»‡u [LINK:/products?brand={brand}]
        
        THÃ”NG TIN KHUYáº¾N MÃƒI/VOUCHER:
        - KHÃ”NG liá»‡t kÃª danh sÃ¡ch khuyáº¿n mÃ£i
        - HÆ°á»›ng dáº«n vÃ o trang Khuyáº¿n mÃ£i: [LINK:/promo]
        
        GIá»šI Háº N:
        - KHÃ”NG thá»ƒ tra cá»©u Ä‘Æ¡n hÃ ng cá»¥ thá»ƒ (cáº§n Ä‘Äƒng nháº­p)
        - KHÃ”NG thá»ƒ xá»­ lÃ½ khiáº¿u náº¡i/Ä‘á»•i tráº£ (cáº§n liÃªn há»‡ CSKH)
        - KHÃ”NG cÃ³ thÃ´ng tin tÃ i khoáº£n (cáº§n Ä‘Äƒng nháº­p)
        - KHÃ”NG thá»ƒ thanh toÃ¡n trá»±c tiáº¿p (cáº§n Ä‘áº·t hÃ ng trÃªn website)
        
        NGUYÃŠN Táº®C TRáº¢ Lá»œI:
        1. Ngáº¯n gá»n, rÃµ rÃ ng, dá»… hiá»ƒu
        2. NgÃ´n ngá»¯ thÃ¢n thiá»‡n, chuyÃªn nghiá»‡p
        3. CHá»ˆ tÆ° váº¥n sáº£n pháº©m CÃ“ TRONG CONTEXT
        4. Khi khÃ´ng cÃ³ thÃ´ng tin: thÃ nh tháº­t nÃ³i khÃ´ng cÃ³
        
        QUY Táº®C FORMATTING:
        1. TUYá»†T Äá»I KHÃ”NG dÃ¹ng markdown: **, ***, *, #, __, ~~
        2. Chá»‰ dÃ¹ng text thuáº§n tÃºy
        3. Liá»‡t kÃª: dÃ¹ng sá»‘ thá»© tá»± (1., 2., 3.) hoáº·c dáº¥u gáº¡ch (-)
        4. TrÃ­ch dáº«n: dÃ¹ng dáº¥u ngoáº·c kÃ©p ""
        """;
    
    public ChatResponse ask(ChatRequest request) {
        try {
            // 1. Validate request
            if (request == null || request.getMessage() == null || request.getMessage().isBlank()) {
                throw new AppException(ErrorCode.INVALID_REQUEST);
            }
            
            // 2. Táº¡o hoáº·c láº¥y sessionId
            String sessionId = request.getSessionId();
            if (sessionId == null || sessionId.isBlank()) {
                sessionId = UUID.randomUUID().toString();
            }
            
            // 3. Láº¥y conversation history
            List<GeminiContent> history = conversationHistory.getOrDefault(sessionId, new ArrayList<>());
            
            // 4. Build request cho Gemini
            GeminiRequest geminiRequest = buildGeminiRequest(request.getMessage(), history);
            
            // 5. Gá»i Gemini API vá»›i retry
            GeminiResponse response = callGeminiWithRetry(geminiRequest, 3);
            
            // 6. Extract reply
            String reply = response.getCandidates().get(0).getContent().getParts().get(0).getText();
            
            // 7. Remove markdown formatting
            reply = reply.replace("***", "").replace("**", "").replace("*", "");
            
            // 8. LÆ°u vÃ o history
            history.add(new GeminiContent("user", request.getMessage()));
            history.add(new GeminiContent("model", reply));
            conversationHistory.put(sessionId, history);
            
            // 9. Giá»›i háº¡n history (giá»¯ 10 cáº·p Q&A gáº§n nháº¥t)
            if (history.size() > 20) {
                history.subList(0, history.size() - 20).clear();
            }
            
            return ChatResponse.builder()
                    .reply(reply)
                    .sessionId(sessionId)
                    .build();
                    
        } catch (Exception e) {
            log.error("Error in chatbot service", e);
            throw new AppException(ErrorCode.UNCATEGORIZED_EXCEPTION);
        }
    }
    
    private GeminiRequest buildGeminiRequest(String userMessage, List<GeminiContent> history) {
        List<GeminiContent> contents = new ArrayList<>();
        
        // Refresh products context náº¿u cáº§n
        refreshProductsContextIfNeeded();
        
        // Táº¡o system prompt
        String systemPrompt = SYSTEM_PROMPT_BASE;
        
        // Chá»‰ thÃªm products context náº¿u cÃ¢u há»i liÃªn quan Ä‘áº¿n sáº£n pháº©m
        if (!isGreetingMessage(userMessage) && isProductRelatedQuestion(userMessage)) {
            String productsContext = getProductsContextForMessage(userMessage);
            if (!productsContext.isEmpty()) {
                systemPrompt += "\n\n" + productsContext;
            }
        }
        
        // Build contents
        if (history.isEmpty()) {
            // Conversation má»›i: thÃªm system prompt
            contents.add(new GeminiContent("user", systemPrompt + "\n\nCÃ¢u há»i cá»§a khÃ¡ch hÃ ng: " + userMessage));
        } else {
            // Conversation cÃ³ history: thÃªm history + message má»›i
            contents.addAll(history);
            
            String messageWithContext = userMessage;
            if (!isGreetingMessage(userMessage) && isProductRelatedQuestion(userMessage)) {
                String productsContext = getProductsContextForMessage(userMessage);
                if (!productsContext.isEmpty()) {
                    messageWithContext = "ThÃ´ng tin sáº£n pháº©m hiá»‡n cÃ³:\n" + productsContext 
                        + "\n\nCÃ¢u há»i cá»§a khÃ¡ch hÃ ng: " + userMessage;
                }
            }
            contents.add(new GeminiContent("user", messageWithContext));
        }
        
        GeminiRequest request = new GeminiRequest();
        request.setContents(contents);
        return request;
    }
    
    private GeminiResponse callGeminiWithRetry(GeminiRequest request, int maxRetries) {
        int retryCount = 0;
        long baseDelay = 2000; // 2 seconds
        
        while (retryCount < maxRetries) {
            try {
                return webClient.post()
                        .uri("/models/" + model + ":generateContent?key=" + apiKey)
                        .contentType(MediaType.APPLICATION_JSON)
                        .bodyValue(request)
                        .retrieve()
                        .bodyToMono(GeminiResponse.class)
                        .block();
                        
            } catch (WebClientResponseException e) {
                int statusCode = e.getStatusCode().value();
                String errorBody = e.getResponseBodyAsString();
                
                // 400 BadRequest: khÃ´ng retry
                if (statusCode == 400) {
                    log.error("Gemini API BadRequest (400): {}", errorBody);
                    throw new AppException(ErrorCode.UNCATEGORIZED_EXCEPTION);
                }
                
                // 404 NotFound: khÃ´ng retry
                if (statusCode == 404) {
                    log.error("Gemini API NotFound (404). Model '{}' not found", model);
                    throw new AppException(ErrorCode.UNCATEGORIZED_EXCEPTION);
                }
                
                // 429 TooManyRequests: retry vá»›i backoff
                if (statusCode == 429) {
                    // Náº¿u limit = 0, khÃ´ng retry
                    if (errorBody.contains("\"limit\": 0")) {
                        log.error("Gemini API quota exceeded (limit = 0)");
                        throw new AppException(ErrorCode.UNCATEGORIZED_EXCEPTION);
                    }
                    
                    if (retryCount < maxRetries) {
                        long delay = baseDelay * (long) Math.pow(2, retryCount);
                        log.warn("Gemini API rate limited. Retrying in {}ms (attempt {}/{})", 
                            delay, retryCount + 1, maxRetries);
                        Thread.sleep(delay);
                        retryCount++;
                        continue;
                    }
                }
                
                throw new AppException(ErrorCode.UNCATEGORIZED_EXCEPTION);
            } catch (Exception e) {
                log.error("Unexpected error calling Gemini API", e);
                throw new AppException(ErrorCode.UNCATEGORIZED_EXCEPTION);
            }
        }
        
        throw new AppException(ErrorCode.UNCATEGORIZED_EXCEPTION);
    }
    
    private void refreshProductsContextIfNeeded() {
        long now = System.currentTimeMillis();
        if (now - lastProductsCacheUpdate > PRODUCTS_CACHE_TTL || cachedProductsContext.isEmpty()) {
            refreshProductsContext();
        }
    }
    
    private void refreshProductsContext() {
        try {
            // Láº¥y sáº£n pháº©m tá»« database
            List<ProductResponse> products = productService.getActiveProducts();
            
            // Giá»›i háº¡n 100 sáº£n pháº©m Ä‘á»ƒ trÃ¡nh prompt quÃ¡ dÃ i
            int maxProducts = Math.min(100, products.size());
            
            // Format thÃ nh text context
            StringBuilder context = new StringBuilder();
            context.append("DANH SÃCH Sáº¢N PHáº¨M Cá»¦A NOVA BEAUTY:\n\n");
            
            for (int i = 0; i < maxProducts; i++) {
                ProductResponse product = products.get(i);
                context.append(String.format("%d. ID: %s | TÃªn: %s", 
                    i + 1, product.getId(), product.getName()));
                
                if (product.getBrand() != null) {
                    context.append(" | ThÆ°Æ¡ng hiá»‡u: ").append(product.getBrand());
                }
                
                if (product.getPrice() != null) {
                    context.append(String.format(" | GiÃ¡: %,.0f VNÄ", product.getPrice()));
                }
                
                if (product.getSkinType() != null) {
                    context.append(" | Loáº¡i da: ").append(product.getSkinType());
                }
                
                context.append("\n");
            }
            
            cachedProductsContext = context.toString();
            lastProductsCacheUpdate = System.currentTimeMillis();
            
            log.info("Products context refreshed: {} products", maxProducts);
            
        } catch (Exception e) {
            log.error("Error refreshing products context", e);
        }
    }
    
    private boolean isGreetingMessage(String message) {
        String lowerMessage = message.toLowerCase().trim();
        String[] greetingKeywords = {
            "hi", "hello", "xin chÃ o", "chÃ o", "chÃ o báº¡n",
            "hey", "háº¿ lÃ´", "alo"
        };
        for (String keyword : greetingKeywords) {
            if (lowerMessage.equals(keyword) || lowerMessage.startsWith(keyword + " ")) {
                return true;
            }
        }
        return false;
    }
    
    private boolean isProductRelatedQuestion(String message) {
        String lowerMessage = message.toLowerCase();
        String[] productKeywords = {
            "sáº£n pháº©m", "má»¹ pháº©m", "kem", "son", "nÆ°á»›c hoa",
            "trang Ä‘iá»ƒm", "chÄƒm sÃ³c", "tÆ° váº¥n", "giÃ¡", "mua", "bÃ¡n",
            "skincare", "makeup", "perfume"
        };
        for (String keyword : productKeywords) {
            if (lowerMessage.contains(keyword)) {
                return true;
            }
        }
        return false;
    }
    
    // ... ThÃªm cÃ¡c methods khÃ¡c nhÆ° getProductsContextForMessage(), 
    // getSubCategoriesContext(), getBrandProductsContext(), etc.
}
```

---

### PHáº¦N 2: FRONTEND (REACTJS)

#### 2.1. Chatbot Service (API Client)

```javascript
import axios from 'axios';

const API_BASE_URL = 'http://localhost:8080'; // Hoáº·c URL backend cá»§a báº¡n

const chatbotService = {
    /**
     * Gá»­i message Ä‘áº¿n chatbot AI
     * @param {string} message - Ná»™i dung tin nháº¯n
     * @param {string} sessionId - Session ID (optional)
     * @returns {Promise<{reply: string, sessionId: string}>}
     */
    async ask(message, sessionId = null) {
        try {
            const payload = { message };
            if (sessionId) {
                payload.sessionId = sessionId;
            }
            
            const response = await axios.post(`${API_BASE_URL}/api/chatbot/ask`, payload);
            
            return response.data.result;
        } catch (error) {
            console.error('[Chatbot Service] ask error:', error);
            throw error;
        }
    }
};

export default chatbotService;
```

#### 2.2. Chatbot Component (UI)

```jsx
import React, { useState, useEffect, useRef } from 'react';
import chatbotService from '~/services/chatbot';
import './Chatbot.scss';

const Chatbot = () => {
    const [isOpen, setIsOpen] = useState(false);
    const [messages, setMessages] = useState([]);
    const [inputMessage, setInputMessage] = useState('');
    const [isLoading, setIsLoading] = useState(false);
    const [sessionId, setSessionId] = useState(null);
    const messagesEndRef = useRef(null);

    // Auto scroll to bottom
    const scrollToBottom = () => {
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
    };

    useEffect(() => {
        scrollToBottom();
    }, [messages]);

    // Add greeting message when open
    useEffect(() => {
        if (isOpen && messages.length === 0) {
            setMessages([
                {
                    type: 'bot',
                    content: 'Xin chÃ o! TÃ´i lÃ  trá»£ lÃ½ AI cá»§a Nova Beauty. TÃ´i cÃ³ thá»ƒ giÃºp gÃ¬ cho báº¡n hÃ´m nay?',
                    timestamp: new Date()
                }
            ]);
        }
    }, [isOpen]);

    const handleSendMessage = async () => {
        if (!inputMessage.trim()) return;

        // Add user message
        const userMessage = {
            type: 'user',
            content: inputMessage,
            timestamp: new Date()
        };
        setMessages(prev => [...prev, userMessage]);
        setInputMessage('');
        setIsLoading(true);

        try {
            // Call API
            const response = await chatbotService.ask(inputMessage, sessionId);
            
            // Update sessionId
            if (response.sessionId) {
                setSessionId(response.sessionId);
            }

            // Add bot message
            const botMessage = {
                type: 'bot',
                content: response.reply,
                timestamp: new Date()
            };
            setMessages(prev => [...prev, botMessage]);
            
        } catch (error) {
            console.error('Error sending message:', error);
            const errorMessage = {
                type: 'bot',
                content: 'Xin lá»—i, Ä‘Ã£ cÃ³ lá»—i xáº£y ra. Vui lÃ²ng thá»­ láº¡i sau.',
                timestamp: new Date()
            };
            setMessages(prev => [...prev, errorMessage]);
        } finally {
            setIsLoading(false);
        }
    };

    const handleKeyPress = (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            handleSendMessage();
        }
    };

    return (
        <>
            {/* Chat button */}
            <button 
                className={`chatbot-button ${isOpen ? 'active' : ''}`}
                onClick={() => setIsOpen(!isOpen)}
            >
                <i className="fas fa-comments"></i>
            </button>

            {/* Chat window */}
            {isOpen && (
                <div className="chatbot-window">
                    {/* Header */}
                    <div className="chatbot-header">
                        <h3>Trá»£ lÃ½ AI Nova Beauty</h3>
                        <button onClick={() => setIsOpen(false)}>
                            <i className="fas fa-times"></i>
                        </button>
                    </div>

                    {/* Messages */}
                    <div className="chatbot-messages">
                        {messages.map((msg, index) => (
                            <div 
                                key={index} 
                                className={`message ${msg.type}`}
                            >
                                <div className="message-content">
                                    {msg.content}
                                </div>
                                <div className="message-time">
                                    {msg.timestamp.toLocaleTimeString('vi-VN', { 
                                        hour: '2-digit', 
                                        minute: '2-digit' 
                                    })}
                                </div>
                            </div>
                        ))}
                        {isLoading && (
                            <div className="message bot">
                                <div className="message-content loading">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </div>
                        )}
                        <div ref={messagesEndRef} />
                    </div>

                    {/* Input */}
                    <div className="chatbot-input">
                        <textarea
                            value={inputMessage}
                            onChange={(e) => setInputMessage(e.target.value)}
                            onKeyPress={handleKeyPress}
                            placeholder="Nháº­p tin nháº¯n..."
                            rows={1}
                            disabled={isLoading}
                        />
                        <button 
                            onClick={handleSendMessage}
                            disabled={isLoading || !inputMessage.trim()}
                        >
                            <i className="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            )}
        </>
    );
};

export default Chatbot;
```

#### 2.3. Chatbot Styles (SCSS)

```scss
.chatbot-button {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    transition: all 0.3s ease;
    z-index: 1000;

    &:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
    }

    &.active {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }
}

.chatbot-window {
    position: fixed;
    bottom: 100px;
    right: 30px;
    width: 380px;
    height: 600px;
    background: white;
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    display: flex;
    flex-direction: column;
    z-index: 1000;
    overflow: hidden;

    .chatbot-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;

        h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        button {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
    }

    .chatbot-messages {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        background: #f5f5f5;

        .message {
            margin-bottom: 16px;
            display: flex;
            flex-direction: column;

            &.user {
                align-items: flex-end;

                .message-content {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    max-width: 70%;
                    padding: 12px 16px;
                    border-radius: 18px 18px 4px 18px;
                }
            }

            &.bot {
                align-items: flex-start;

                .message-content {
                    background: white;
                    color: #333;
                    max-width: 70%;
                    padding: 12px 16px;
                    border-radius: 18px 18px 18px 4px;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);

                    &.loading {
                        display: flex;
                        gap: 4px;
                        padding: 16px;

                        span {
                            width: 8px;
                            height: 8px;
                            border-radius: 50%;
                            background: #667eea;
                            animation: bounce 1.4s infinite ease-in-out;

                            &:nth-child(1) {
                                animation-delay: -0.32s;
                            }
                            &:nth-child(2) {
                                animation-delay: -0.16s;
                            }
                        }
                    }
                }
            }

            .message-time {
                font-size: 11px;
                color: #999;
                margin-top: 4px;
            }
        }
    }

    .chatbot-input {
        padding: 16px;
        background: white;
        border-top: 1px solid #e0e0e0;
        display: flex;
        gap: 12px;

        textarea {
            flex: 1;
            border: 1px solid #e0e0e0;
            border-radius: 24px;
            padding: 12px 16px;
            font-size: 14px;
            resize: none;
            font-family: inherit;

            &:focus {
                outline: none;
                border-color: #667eea;
            }
        }

        button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;

            &:hover:not(:disabled) {
                transform: scale(1.1);
            }

            &:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }
        }
    }
}

@keyframes bounce {
    0%, 80%, 100% {
        transform: scale(0);
    }
    40% {
        transform: scale(1);
    }
}
```

---

### PHáº¦N 3: Cáº¤U HÃŒNH VÃ€ DEPLOYMENT

#### 3.1. Environment Variables

**Backend (application.yaml):**

```yaml
gemini:
  apiKey: ${GEMINI_API_KEY:your-api-key-here}
  model: gemini-1.5-flash # Hoáº·c gemini-2.0-flash, gemini-pro

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/nova_beauty
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:password}
```

**Frontend (.env):**

```
REACT_APP_API_BASE_URL=http://localhost:8080
```

#### 3.2. Láº¥y Gemini API Key

1. Truy cáº­p [Google AI Studio](https://makersuite.google.com/app/apikey)
2. ÄÄƒng nháº­p báº±ng tÃ i khoáº£n Google
3. Click "Create API Key"
4. Copy API key vÃ  lÆ°u vÃ o environment variable

#### 3.3. Testing

**Test API báº±ng Postman/cURL:**

```bash
curl -X POST http://localhost:8080/api/chatbot/ask \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Báº¡n cÃ³ sáº£n pháº©m nÃ o cho da dáº§u khÃ´ng?",
    "sessionId": null
  }'
```

**Expected Response:**

```json
{
  "code": 1000,
  "result": {
    "reply": "ChÃ o báº¡n! Nova Beauty cÃ³ cÃ¡c sáº£n pháº©m chÄƒm sÃ³c da cho da dáº§u. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c sáº£n pháº©m báº¡n cÃ³ thá»ƒ tham kháº£o áº¡:",
    "sessionId": "123e4567-e89b-12d3-a456-426614174000"
  }
}
```

---

## ğŸ¯ TÃNH NÄ‚NG NÃ‚NG CAO

### 1. Smart Context Loading

**Váº¥n Ä‘á»:** Prompt quÃ¡ dÃ i náº¿u load táº¥t cáº£ sáº£n pháº©m

**Giáº£i phÃ¡p:**

- Chá»‰ load context khi cÃ¢u há»i liÃªn quan Ä‘áº¿n sáº£n pháº©m
- Filter sáº£n pháº©m theo keyword
- Æ¯u tiÃªn danh má»¥c con khi há»i chung
- Giá»›i háº¡n 50-100 sáº£n pháº©m trong context

**Implementation:**

```java
private String getProductsContextForMessage(String userMessage) {
    // Extract keywords
    String[] productKeywords = extractProductKeywords(userMessage);
    
    if (productKeywords.length == 0) {
        return "";
    }
    
    // Kiá»ƒm tra cÃ¢u há»i chung hay cá»¥ thá»ƒ
    boolean isSpecific = isSpecificProductQuestion(userMessage);
    
    if (!isSpecific) {
        // CÃ¢u há»i chung: tráº£ vá» danh má»¥c con
        String subCategoriesContext = getSubCategoriesContext(productKeywords[0]);
        if (!subCategoriesContext.isEmpty()) {
            return subCategoriesContext;
        }
    }
    
    // Kiá»ƒm tra cÃ¢u há»i vá» brand
    String brandName = extractBrandFromMessage(userMessage);
    if (brandName != null) {
        String brandProductsContext = getBrandProductsContext(brandName);
        if (!brandProductsContext.isEmpty()) {
            return brandProductsContext;
        }
    }
    
    // Tráº£ vá» sáº£n pháº©m filtered
    return getFilteredProductsContext(productKeywords);
}
```

### 2. Subcategories Context

**Má»¥c Ä‘Ã­ch:** Khi user há»i chung (vÃ­ dá»¥: "cÃ³ son gÃ¬"), tráº£ vá» danh má»¥c con Ä‘á»ƒ user chá»n

**Implementation:**

```java
private String getSubCategoriesContext(String keyword) {
    try {
        // TÃ¬m category theo keyword
        List<CategoryResponse> categories = categoryService.getAllCategories();
        CategoryResponse mainCategory = null;
        
        // TÃ¬m category phÃ¹ há»£p
        for (CategoryResponse cat : categories) {
            if (cat.getName().toLowerCase().contains(keyword.toLowerCase())) {
                mainCategory = cat;
                break;
            }
        }
        
        if (mainCategory == null) {
            return "";
        }
        
        // Láº¥y subcategories
        List<CategoryResponse> subCategories = categoryService.getSubCategories(mainCategory.getId());
        
        if (subCategories.isEmpty()) {
            return "";
        }
        
        // Format context
        StringBuilder context = new StringBuilder();
        context.append("=== DANH Má»¤C CON Cá»¦A ").append(mainCategory.getName().toUpperCase()).append(" ===\n");
        context.append("TUYá»†T Äá»I CHá»ˆ LIá»†T KÃŠ ÄÃšNG Y Há»†T CÃC DANH Má»¤C CON SAU:\n\n");
        
        for (int i = 0; i < subCategories.size(); i++) {
            CategoryResponse subCat = subCategories.get(i);
            context.append(String.format("%d. %s", i + 1, subCat.getName()));
            if (subCat.getProductCount() != null && subCat.getProductCount() > 0) {
                context.append(String.format(" (%d sáº£n pháº©m)", subCat.getProductCount()));
            }
            context.append("\n");
        }
        
        return context.toString();
        
    } catch (Exception e) {
        log.error("Error getting subcategories", e);
        return "";
    }
}
```

### 3. Brand Products Context

**Má»¥c Ä‘Ã­ch:** Khi user há»i vá» thÆ°Æ¡ng hiá»‡u (vÃ­ dá»¥: "cÃ³ son dior"), tráº£ vá» sáº£n pháº©m cá»§a brand Ä‘Ã³

**Implementation:**

```java
private String getBrandProductsContext(String brandName) {
    try {
        // Search products by brand
        List<ProductResponse> brandProducts = productService.searchProducts(brandName)
            .stream()
            .filter(p -> p.getBrand() != null && p.getBrand().equalsIgnoreCase(brandName))
            .collect(Collectors.toList());
        
        if (brandProducts.isEmpty()) {
            return "";
        }
        
        // Format context
        StringBuilder context = new StringBuilder();
        context.append("=== Sáº¢N PHáº¨M THEO THÆ¯Æ NG HIá»†U: ").append(brandName.toUpperCase()).append(" ===\n");
        context.append("TÃŠN THÆ¯Æ NG HIá»†U: ").append(brandName).append("\n");
        context.append("Sá» LÆ¯á»¢NG Sáº¢N PHáº¨M: ").append(brandProducts.size()).append("\n\n");
        
        // Giá»›i háº¡n 50 sáº£n pháº©m
        int maxProducts = Math.min(50, brandProducts.size());
        for (int i = 0; i < maxProducts; i++) {
            ProductResponse product = brandProducts.get(i);
            context.append(String.format("%d. ID: %s | TÃªn: %s", 
                i + 1, product.getId(), product.getName()));
            if (product.getPrice() != null) {
                context.append(String.format(" | GiÃ¡: %,.0f VNÄ", product.getPrice()));
            }
            context.append("\n");
        }
        
        context.append("\nQUY Táº®C KHI TRáº¢ Lá»œI:\n");
        context.append("- Náº¿u cÃ³ <10 sáº£n pháº©m: liá»‡t kÃª táº¥t cáº£ tÃªn vÃ  link [LINK:/product/{id}]\n");
        context.append("- Náº¿u cÃ³ >=10 sáº£n pháº©m: Ä‘Æ°a link [LINK:/products?brand=" + brandName + "]\n");
        
        return context.toString();
        
    } catch (Exception e) {
        log.error("Error getting brand products", e);
        return "";
    }
}
```

### 4. Retry Logic With Exponential Backoff

**Má»¥c Ä‘Ã­ch:** Xá»­ lÃ½ quota exceeded vÃ  network errors

**Implementation Ä‘Ã£ Ä‘Æ°á»£c trÃ¬nh bÃ y á»Ÿ pháº§n ChatbotService.callGeminiWithRetry()**

### 5. Scheduled Cache Refresh

**Má»¥c Ä‘Ã­ch:** Tá»± Ä‘á»™ng refresh cache má»—i 30 phÃºt

**Implementation:**

```java
@Scheduled(fixedRate = PRODUCTS_CACHE_TTL)
public void scheduledRefreshProductsContext() {
    log.info("Scheduled task: Refreshing products context");
    refreshProductsContext();
}
```

**Configuration:**

```java
@Configuration
@EnableScheduling
public class SchedulingConfig {
    // Spring Boot sáº½ tá»± Ä‘á»™ng cháº¡y @Scheduled tasks
}
```

---

## ğŸ”’ Báº¢O Máº¬T VÃ€ Tá»I Æ¯U

### 1. Báº£o Máº­t API Key

```yaml
# KHÃ”NG commit API key vÃ o Git
gemini:
  apiKey: ${GEMINI_API_KEY}  # Láº¥y tá»« environment variable
```

```bash
# Set environment variable
export GEMINI_API_KEY="your-actual-api-key"
```

### 2. Rate Limiting

```java
@RateLimiter(name = "chatbot", fallbackMethod = "rateLimitFallback")
public ChatResponse ask(ChatRequest request) {
    // ...
}

public ChatResponse rateLimitFallback(ChatRequest request, Throwable t) {
    return ChatResponse.builder()
        .reply("Xin lá»—i, há»‡ thá»‘ng Ä‘ang quÃ¡ táº£i. Vui lÃ²ng thá»­ láº¡i sau.")
        .build();
}
```

### 3. Input Validation

```java
@Valid
public class ChatRequest {
    @NotBlank(message = "Message cannot be blank")
    @Size(max = 1000, message = "Message too long")
    private String message;
    
    private String sessionId;
}
```

### 4. Caching vá»›i Redis (Production)

```java
@Configuration
public class RedisConfig {
    @Bean
    public RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory factory) {
        RedisTemplate<String, Object> template = new RedisTemplate<>();
        template.setConnectionFactory(factory);
        return template;
    }
}

// Usage
@Autowired
private RedisTemplate<String, Object> redisTemplate;

private void saveConversationHistory(String sessionId, List<GeminiContent> history) {
    redisTemplate.opsForValue().set("chat:" + sessionId, history, 30, TimeUnit.MINUTES);
}
```

---

## ğŸ“Š MONITORING VÃ€ LOGGING

### 1. Logging Strategy

```java
// Request logging
log.info("Chatbot request received: sessionId={}, message={}", 
    sessionId, request.getMessage().substring(0, Math.min(50, request.getMessage().length())));

// Response logging
log.info("Chatbot response sent: sessionId={}, reply_length={}", 
    sessionId, reply.length());

// Error logging
log.error("Error calling Gemini API: status={}, message={}, body={}", 
    statusCode, e.getMessage(), errorBody, e);
```

### 2. Metrics

```java
@Autowired
private MeterRegistry meterRegistry;

private void recordChatbotMetrics(boolean success) {
    Counter.builder("chatbot.requests")
        .tag("status", success ? "success" : "error")
        .register(meterRegistry)
        .increment();
}
```

---

## ğŸ§ª TESTING

### 1. Unit Tests

```java
@Test
public void testAsk_Success() {
    // Arrange
    ChatRequest request = ChatRequest.builder()
        .message("Báº¡n cÃ³ sáº£n pháº©m nÃ o cho da dáº§u khÃ´ng?")
        .build();
    
    // Act
    ChatResponse response = chatbotService.ask(request);
    
    // Assert
    assertNotNull(response);
    assertNotNull(response.getReply());
    assertNotNull(response.getSessionId());
}
```

### 2. Integration Tests

```java
@SpringBootTest
@AutoConfigureMockMvc
public class ChatbotControllerTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @Test
    public void testAskEndpoint() throws Exception {
        mockMvc.perform(post("/api/chatbot/ask")
                .contentType(MediaType.APPLICATION_JSON)
                .content("{\"message\":\"Xin chÃ o\"}"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.code").value(1000))
                .andExpect(jsonPath("$.result.reply").exists())
                .andExpect(jsonPath("$.result.sessionId").exists());
    }
}
```

---

## ğŸ“š TÃ€I LIá»†U THAM KHáº¢O

### Google Gemini API
- **Documentation**: https://ai.google.dev/docs
- **API Reference**: https://ai.google.dev/api/rest/v1/models/generateContent
- **Get API Key**: https://makersuite.google.com/app/apikey
- **Usage Limits**: https://ai.dev/usage?tab=rate-limit

### Alternative AI Services
- **OpenAI GPT**: https://platform.openai.com/docs/api-reference
- **Anthropic Claude**: https://docs.anthropic.com/claude/reference
- **Cohere**: https://docs.cohere.com/

---

## âœ… CHECKLIST IMPLEMENTATION

### Backend
- [ ] Táº¡o database vÃ  tables (products, categories)
- [ ] Implement ProductService.getActiveProducts()
- [ ] Implement CategoryService vá»›i subcategories
- [ ] Implement ChatbotService vá»›i cache mechanism
- [ ] Implement retry logic vá»›i exponential backoff
- [ ] Táº¡o ChatbotController vá»›i endpoint /api/chatbot/ask
- [ ] Setup Gemini API key trong application.yaml
- [ ] Test API vá»›i Postman/cURL
- [ ] Add logging vÃ  error handling
- [ ] (Optional) Setup Redis cho conversation history

### Frontend
- [ ] Táº¡o chatbot service (API client)
- [ ] Implement Chatbot component (UI)
- [ ] Add styling (SCSS/CSS)
- [ ] Handle loading state
- [ ] Handle errors gracefully
- [ ] Auto-scroll to bottom
- [ ] Save sessionId trong localStorage
- [ ] Test UI vá»›i cÃ¡c use cases

### Deployment
- [ ] Set environment variables (GEMINI_API_KEY, DB credentials)
- [ ] Build backend (mvn clean package)
- [ ] Build frontend (npm run build)
- [ ] Deploy backend (Heroku, AWS, etc.)
- [ ] Deploy frontend (Vercel, Netlify, etc.)
- [ ] Configure CORS
- [ ] Setup SSL/HTTPS
- [ ] Monitor logs vÃ  metrics

### Testing
- [ ] Test greeting messages
- [ ] Test product queries (chung vÃ  cá»¥ thá»ƒ)
- [ ] Test brand queries
- [ ] Test category queries
- [ ] Test conversation history
- [ ] Test error handling (invalid input, API errors)
- [ ] Test performance (response time)
- [ ] Test vá»›i nhiá»u users Ä‘á»“ng thá»i

---

## ğŸš€ NEXT STEPS & IMPROVEMENTS

### Short Term
1. Add product images trong response
2. Implement "Quick Replies" buttons
3. Add typing indicator animation
4. Save conversation history vÃ o database

### Medium Term
1. Multi-language support (English, Vietnamese)
2. Voice input/output
3. Product recommendations based on chat history
4. Integration vá»›i shopping cart

### Long Term
1. Custom AI model training
2. Sentiment analysis
3. Automated customer support tickets
4. Analytics dashboard
5. A/B testing different prompts

---

## ğŸ’¡ Máº¸O VÃ€ LÆ¯U Ã

### 1. System Prompt lÃ  Quan Trá»ng Nháº¥t

System prompt quyáº¿t Ä‘á»‹nh 80% cháº¥t lÆ°á»£ng chatbot. Cáº§n:
- RÃµ rÃ ng, chi tiáº¿t
- ÄÆ°a ra rules cá»¥ thá»ƒ
- CÃ³ vÃ­ dá»¥ format
- Nháº¥n máº¡nh "CHá»ˆ dÃ¹ng thÃ´ng tin tá»« context"

### 2. Context Loading Strategy

- KHÃ”NG load táº¥t cáº£ sáº£n pháº©m vÃ o má»i request
- Chá»‰ load context khi cáº§n
- Filter sáº£n pháº©m theo keyword
- Giá»›i háº¡n sá»‘ lÆ°á»£ng sáº£n pháº©m (50-100)

### 3. Conversation History

- Giá»›i háº¡n history (10-20 cáº·p Q&A)
- Clear history khi user refresh
- LÆ°u sessionId trong localStorage (frontend)
- DÃ¹ng Redis cho production

### 4. Error Handling

- Validate input trÆ°á»›c khi gá»i API
- Retry cho 429 (quota exceeded)
- KHÃ”NG retry cho 400, 404
- CÃ³ fallback message cho users

### 5. Performance

- Cache sáº£n pháº©m trong 30 phÃºt
- Scheduled task Ä‘á»ƒ refresh cache
- Optimize database queries (JOIN FETCH)
- DÃ¹ng connection pooling

### 6. Testing

- Test vá»›i real users
- Monitor response time
- Track error rates
- A/B test different prompts

---

**LÆ¯U Ã QUAN TRá»ŒNG:**

1. **API Key**: TUYá»†T Äá»I KHÃ”NG commit API key vÃ o Git
2. **Rate Limiting**: Gemini API cÃ³ giá»›i háº¡n requests per minute
3. **Cost**: Monitor usage Ä‘á»ƒ trÃ¡nh chi phÃ­ cao
4. **Privacy**: KHÃ”NG lÆ°u thÃ´ng tin nháº¡y cáº£m cá»§a users
5. **Fallback**: LuÃ´n cÃ³ plan B khi AI API down

---

**Káº¾T LUáº¬N:**

ÄÃ¢y lÃ  má»™t há»‡ thá»‘ng Chatbot AI hoÃ n chá»‰nh, production-ready vá»›i:
- âœ… Smart context loading
- âœ… Conversation history
- âœ… Error handling & retry logic
- âœ… Caching mechanism
- âœ… Frontend UI Ä‘áº¹p
- âœ… Scalable architecture

Báº¡n cÃ³ thá»ƒ customize vÃ  má»Ÿ rá»™ng dá»±a trÃªn nhu cáº§u cá»¥ thá»ƒ cá»§a dá»± Ã¡n!
